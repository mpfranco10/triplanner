(this["webpackJsonptrip-planner"]=this["webpackJsonptrip-planner"]||[]).push([[0],{289:function(e,t,a){},454:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a.n(s),r=a(33),i=a.n(r),c=(a(276),function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,465)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),s(e),n(e),r(e),i(e)}))}),l=a(38),o=a(269),d=a(36),h=a(55),j=a(84),u=a(3),p={user:{}};var b=function(e){return{type:"user/userChanged",payload:e}},m=a(2);var O=Object(d.h)((function(e){var t=Object(h.b)(),a=t.isLoading,s=t.isAuthenticated,n=t.error,r=t.user,i=Object(j.c)();return a?Object(m.jsx)("div",{className:"loading",children:Object(m.jsx)("div",{className:"loader"})}):n?Object(m.jsxs)("div",{children:["Oops... ",n.message]}):s?(console.log("callback called"),i(b(r)),Object(m.jsx)(d.b,{push:!0,to:"/plan"})):(i(b({})),Object(m.jsx)(d.b,{push:!0,to:"/"}))})),x=(a(289),a(12)),v=a(13),f=a(15),g=a(14),y=a(16),S=a(21),C=a(119),N=a(53),k=a(168),D=a(98),w=a(23);var I=function(e){var t="";return 1===e.pageNumber?t="En esta secci\xf3n puede ingresar la informaci\xf3n b\xe1sica de su viaje: el rango de fechas del viaje, el pa\xeds y la ciudad que desea visitar. Al hacer click en aceptar podr\xe1 empezar a planear su viaje. \n Si ya tiene viajes planeados, puede verlos en la secci\xf3n mis viajes.":2===e.pageNumber&&(t="Para planear su viaje puede buscar los lugares que desee visitar en el mapa, agendarlos en el calendario, agregar listas de compras, presupuesto, y notas. En cada p\xe1gina, encontrar\xe1 el s\xedmnbolo '?', que le ayudar\xe1 a entender el prop\xf3sito de cada herramienta."),Object(m.jsxs)(w.a,{show:e.show,onHide:e.handleClose,children:[Object(m.jsx)(w.a.Header,{closeButton:!0,children:Object(m.jsx)(w.a.Title,{children:"Ayuda"})}),Object(m.jsx)(w.a.Body,{children:t}),Object(m.jsx)(w.a.Footer,{children:Object(m.jsx)(S.a,{variant:"primary",onClick:e.handleClose,children:"Entendido"})})]})};var M=function(e){var t,a=Object(s.useState)(!1),n=Object(y.a)(a,2),r=n[0],i=n[1],c=function(){return i(!0)},o=Object(h.b)().user,d=function(){var e=Object(h.b)(),t=e.isAuthenticated,a=e.logout,s=e.loginWithRedirect;return t?Object(m.jsxs)(N.a,{className:"justify-content-center",children:[Object(m.jsx)(N.a.Link,{className:"center",children:Object(m.jsx)("button",{type:"button",className:"btn btn-info","data-toggle":"modal","data-target":"#miModal4",onClick:c,children:"Ayuda"})}),Object(m.jsx)(N.a.Link,{className:"center",children:Object(m.jsx)(S.a,{variant:"danger",onClick:function(){return a({returnTo:window.location.origin})},children:"Cerrar sesi\xf3n"})})," "]}):Object(m.jsxs)(N.a,{className:"justify-content-center",children:[Object(m.jsx)(N.a.Link,{className:"center",children:Object(m.jsx)(S.a,{variant:"success",onClick:function(){return s()},children:"Iniciar sesi\xf3n"})})," "]})},j=e.showLinks;t=j?Object(m.jsxs)(N.a,{justify:!0,className:"me-auto",children:[Object(m.jsx)(N.a.Link,{children:Object(m.jsx)(l.b,{to:"/mytrip",children:" Resumen"})}),Object(m.jsx)(N.a.Link,{children:Object(m.jsx)(l.b,{to:"/map",children:" Mapa"})}),Object(m.jsxs)(k.a,{title:"Informaci\xf3n \xfatil",id:"collasible-nav-dropdown",children:[Object(m.jsx)(k.a.Item,{children:Object(m.jsx)(l.b,{to:"/list",className:"dropdown-item",children:"Lista de compras"})}),Object(m.jsxs)(k.a.Item,{children:[" ",Object(m.jsx)(l.b,{to:"/notes",className:"dropdown-item",children:"Notas"})]})]}),Object(m.jsx)(N.a.Link,{children:Object(m.jsx)(l.b,{to:"/schedule",children:"Itinerario"})}),Object(m.jsx)(N.a.Link,{children:Object(m.jsx)(l.b,{to:"/budget",children:"Presupuesto"})})]}):Object(m.jsx)(N.a,{justify:!0,className:"me-auto"});var u=j?2:1;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(I,{show:r,handleClose:function(){return i(!1)},pageNumber:u}),Object(m.jsx)(C.a,{collapseOnSelect:!0,expand:"lg",className:"color",fixed:"top",children:Object(m.jsxs)(D.a,{fluid:!0,children:[Object(m.jsx)(C.a.Brand,{children:Object(m.jsxs)(l.b,{to:{pathname:"/plan",state:{user:o}},children:[Object(m.jsx)("img",{width:"30",src:"logotrip.png",height:"30",className:"d-inline-block align-top",alt:""}),Object(m.jsx)("span",{className:" logo-pad",children:"TriPlanner "})]})}),Object(m.jsx)(C.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(m.jsxs)(C.a.Collapse,{id:"responsive-navbar-nav",children:[t,Object(m.jsx)(d,{})]})]})})]})},T=a(116),L=a(79),H=a(258),P=a(200),E=a(257),B=a.n(E),F={selectedTrip:{}};var q=Object(L.b)({trip:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;return"trip/selectedChanged"===t.type?Object(u.a)(Object(u.a)({},e),{},{selectedTrip:t.payload}):e},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;return"user/userChanged"===t.type?Object(u.a)(Object(u.a)({},e),{},{user:t.payload}):e}}),R={key:"root",storage:B.a},z=Object(P.a)(R,q);var A=function(){var e=Object(L.c)(z,Object(L.a)(H.a)),t=Object(P.b)(e,null,(function(){}));return{store:e,persistor:t}},V=a(27),Y=a(30),U=a(26),_=a(24),G=a.n(_),W=a(101),K=3600,$=86400,Q={isPlaying:!0,size:120,strokeWidth:6},Z=function(e,t){return Object(m.jsxs)("div",{className:"time-wrapper",children:[Object(m.jsx)("div",{className:"time",children:t}),Object(m.jsx)("div",{children:e})]})},J=A().store,X=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).state={tripDate:"",city:"",endDate:void 0,places:0,events:0,objects:0},s}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=J.getState().trip.selectedTrip;if(void 0!==t){this.setState({trip:t});var a=new Date(t.calendar.startDate),s=a.toLocaleString("default",{month:"long"});this.setState({tripDate:s+", "+a.getDate()+", "+a.getFullYear()}),this.setState({city:t.selectedCity.split(",")[0]}),this.setState({endDate:a});var n=t.id;G.a.get("http://localhost:5000/widgets/"+n,{headers:{"Content-Type":"application/json"}}).then((function(t){var a=t.data;e.setState({places:a.places,events:a.events,objects:a.objects})}))}else this.props.history.push("/plan")}},{key:"render",value:function(){if(void 0===this.state.endDate)return Object(m.jsxs)("div",{className:"container-fluid",children:[Object(m.jsx)("div",{className:"row",id:"banner",children:Object(m.jsx)("div",{className:"col-2 col-offset-0",children:Object(m.jsx)(M,{})})}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("div",{className:"color",children:Object(m.jsxs)("ol",{className:"breadcrumb",children:[Object(m.jsx)("li",{className:"breadcrumb-item",children:Object(m.jsx)("a",{href:"/",children:"Inicio"})}),Object(m.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:"Resumen"})]})})]});var e=Date.now()/1e3,t=this.state.endDate/1e3-e,a=Math.ceil(t/$)*$;return Object(m.jsxs)("div",{className:"container-fluid",children:[Object(m.jsx)("div",{className:"row",id:"banner",children:Object(m.jsx)("div",{className:"col-2 col-offset-0",children:Object(m.jsx)(M,{showLinks:!0,history:this.props.history})})}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("div",{className:"color",children:Object(m.jsxs)("ol",{className:"breadcrumb",children:[Object(m.jsx)("li",{className:"breadcrumb-item",children:Object(m.jsx)("a",{href:"/",children:"Inicio"})}),Object(m.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:"Resumen"})]})}),Object(m.jsx)("div",{className:"container-fluid",children:Object(m.jsx)("div",{className:"hero-image-2",children:Object(m.jsxs)("div",{className:"hero-text-2",children:[Object(m.jsxs)("h1",{children:["Mi viaje a ",this.state.city]}),Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)(T.CountdownCircleTimer,Object(u.a)(Object(u.a)({},Q),{},{colors:[["#05668d"]],duration:a,initialRemainingTime:t,children:function(e){var t=e.elapsedTime;return Z("d\xedas",(a-t)/$|0)}})),Object(m.jsx)(T.CountdownCircleTimer,Object(u.a)(Object(u.a)({},Q),{},{colors:[["#679436"]],duration:$,initialRemainingTime:t%$,onComplete:function(e){return[t-e>K]},children:function(e){var t=e.elapsedTime;return Z("horas",($-t)%$/K|0)}})),Object(m.jsx)(T.CountdownCircleTimer,Object(u.a)(Object(u.a)({},Q),{},{colors:[["#000000"]],duration:K,initialRemainingTime:t%K,onComplete:function(e){return[t-e>60]},children:function(e){var t=e.elapsedTime;return Z("minutos",(K-t)%K/60|0)}})),Object(m.jsx)(T.CountdownCircleTimer,Object(u.a)(Object(u.a)({},Q),{},{colors:[["#05668d"]],duration:60,initialRemainingTime:t%60,onComplete:function(e){return[t-e>0]},children:function(e){var t=e.elapsedTime;return Z("segundos",60-t|0)}}))]})]})})}),Object(m.jsx)("div",{className:"container",style:{marginTop:"50px"},children:Object(m.jsxs)(Y.a,{children:[Object(m.jsx)(U.a,{className:"page-hero d-flex align-items-center justify-content-center",children:Object(m.jsxs)(V.a,{className:"text-center",style:{width:"18rem",height:"11rem"},children:[Object(m.jsx)(V.a.Header,{children:"Lugares guardados"}),Object(m.jsx)(V.a.Body,{children:Object(m.jsx)(V.a.Title,{children:Object(m.jsxs)("h1",{children:[" ",Object(m.jsx)(W.d,{style:{marginRight:"10px"}}),this.state.places]})})})]})}),Object(m.jsx)(U.a,{className:"page-hero d-flex align-items-center justify-content-center",children:Object(m.jsxs)(V.a,{className:"text-center",style:{width:"18rem",height:"11rem"},children:[Object(m.jsx)(V.a.Header,{children:"Eventos planeados"}),Object(m.jsx)(V.a.Body,{children:Object(m.jsx)(V.a.Title,{children:Object(m.jsxs)("h1",{children:[Object(m.jsx)(W.b,{style:{marginRight:"10px"}})," ",this.state.events]})})})]})}),Object(m.jsx)(U.a,{className:"page-hero d-flex align-items-center justify-content-center",children:Object(m.jsxs)(V.a,{className:"text-center",style:{width:"18rem",height:"11rem"},children:[Object(m.jsx)(V.a.Header,{children:"Objetos en listas de compras"}),Object(m.jsx)(V.a.Body,{children:Object(m.jsx)(V.a.Title,{children:Object(m.jsxs)("h1",{children:[Object(m.jsx)(W.a,{style:{marginRight:"10px"}})," ",this.state.objects]})})})]})})]})})]})}}]),a}(n.a.Component),ee=a(25),te=a(22),ae=a(118),se=a(464),ne=a(69),re=a(158),ie=a(40),ce=a(102),le=a(31),oe=a(263),de={width:"100%",height:"85vh"},he=["places"],je={url:"http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|f47373"},ue=["#E91E63","#673AB7","#FFEB3B","#9C27B0","#00BCD4","#607D88","#CDDC39","#8ED1FC","#F78DA7","#FCB900","#4CAF50","#BF360C","#13567C","#AEA1FF","#008B02","#","#808900","#7BDCB5","#A1887F","#525252","#FA28FF","#FF8A65","#880E4F"],pe=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).handleMarkerClick=function(e,t){var a=Object(te.a)(s.state.myPlaces),n=a.findIndex((function(e){return e.id===t})),r=a[n];a.splice(n,1),a.unshift(r),s.setState({myPlaces:a})},s.deletePlace=function(e,t){var a=Object(te.a)(s.state.myPlaces),n=a.findIndex((function(e){return e.id===t}));a.splice(n,1),s.setState({myPlaces:a}),G.a.delete("http://localhost:5000/places/"+s.props.tripId+"/"+t).then((function(e){console.log("deleted place")}))},s.sortPlaces=function(e){var t=e.target.value,a=[];"1"===t?((a=Object(te.a)(s.state.myPlaces)).sort(s.dynamicSort("colorCode")),s.setState({myPlaces:a})):"2"===t&&((a=Object(te.a)(s.state.myPlaces)).sort(s.dynamicSort("name")),s.setState({myPlaces:a})),s.setState({value:t})},s.handleChangeComplete=function(e,t){var a={url:"http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|"+e.hex.replace("#","")},n=Object(te.a)(s.state.myPlaces),r=n.findIndex((function(e){return e.id===t}));n[r].color=a,n[r].colorCode=e.hex;var i=n[r];delete i._id,s.setState({myPlaces:n}),G.a.put("http://localhost:5000/places/"+s.props.tripId+"/"+t,i).then((function(e){console.log("updated color")}))},s.centerMarker=function(e,t){"function"===typeof s.props.onChange&&s.props.onChange(t)},s.state={myPlaces:[],activeKey:"0",value:"0"},s.autocomplete=null,s.onLoad=s.onLoad.bind(Object(ee.a)(s)),s.onPlaceChanged=s.onPlaceChanged.bind(Object(ee.a)(s)),s.handleChangeComplete=s.handleChangeComplete.bind(Object(ee.a)(s)),s.handleMarkerClick=s.handleMarkerClick.bind(Object(ee.a)(s)),s.deletePlace=s.deletePlace.bind(Object(ee.a)(s)),s.sortPlaces=s.sortPlaces.bind(Object(ee.a)(s)),s.dynamicSort=s.dynamicSort.bind(Object(ee.a)(s)),s.resetColors=s.resetColors.bind(Object(ee.a)(s)),s.centerMarker=s.centerMarker.bind(Object(ee.a)(s)),s}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=this;console.log(this.props.tripId),G.a.get("http://localhost:5000/places/"+this.props.tripId,{headers:{"Content-Type":"application/json"}}).then((function(t){var a=t.data;e.setState({myPlaces:a});e.sortPlaces({target:{value:"2"}})}))}},{key:"onLoad",value:function(e){this.autocomplete=e}},{key:"onPlaceChanged",value:function(){if(null!==this.autocomplete){var e=this.autocomplete.getPlace().place_id;if(this.state.myPlaces.some((function(t){return t.id===e})));else{var t=this.autocomplete.getPlace().geometry.location.lat(),a=this.autocomplete.getPlace().geometry.location.lng(),s=this.autocomplete.getPlace().name,n=this.state.myPlaces,r={id:this.autocomplete.getPlace().place_id,location:{lat:t,lng:a},name:s,detail:this.autocomplete.getPlace(),tripId:this.props.tripId};n.unshift(r),this.setState({myPlaces:n}),G.a.post("http://localhost:5000/places",r).then((function(e){console.log("saved")}))}}else console.log("Autocomplete is not loaded yet!")}},{key:"dynamicSort",value:function(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(a,s){var n=a[e],r=s[e];return void 0===n&&(n="zzzzzz"),void 0===r&&(r="zzzzzz"),(n<r?-1:n>r?1:0)*t}}},{key:"resetColors",value:function(){var e=Object(te.a)(this.state.myPlaces);e.forEach((function(e){delete e.colorCode,delete e.color})),this.setState({myPlaces:e}),G.a.put("http://localhost:5000/places/"+this.props.tripId+"/colors").then((function(e){console.log("updated colors")}))}},{key:"render",value:function(){var e,t,a=this,s=this.props,n=s.center,r=s.zoom;return Object(m.jsx)("div",{style:{height:"80vh",width:"100%"},children:Object(m.jsxs)(Y.a,{children:[Object(m.jsx)(U.a,{xl:8,children:Object(m.jsx)(ae.c,{googleMapsApiKey:"AIzaSyDSymRKtpFQbaTLW8RovSLfZpjaD0WQow4",id:"script-loader",libraries:he,language:"es",children:Object(m.jsxs)(ae.b,{mapContainerStyle:de,id:"googleMapS",center:n,zoom:r,children:[Object(m.jsx)(ae.a,{onLoad:this.onLoad,onPlaceChanged:this.onPlaceChanged,restrictions:{country:this.props.country},children:Object(m.jsx)("input",{type:"text",placeholder:"Buscar un lugar para agregar",onFocus:function(e){return e.target.value=""},style:{boxSizing:"border-box",border:"1px solid transparent",width:"50%",height:"32px",padding:"0 12px",borderRadius:"3px",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.3)",fontSize:"14px",outline:"none",textOverflow:"ellipses",position:"absolute",left:"50%",marginLeft:"-120px"}})}),this.state.myPlaces.map((function(e,t){return Object(m.jsx)(ae.d,{position:e.location,icon:void 0===e.color?je:e.color,onClick:function(t){return a.handleMarkerClick(t,e.id)}},e.name)}))]})})}),Object(m.jsxs)(U.a,{xl:4,children:[Object(m.jsxs)(Y.a,{style:{marginBottom:"10px"},className:"map-right-div",children:[Object(m.jsx)(U.a,{xs:6,lg:7,children:Object(m.jsxs)("div",{style:{margin:"auto"},children:[Object(m.jsx)("div",{id:"first",children:(e="Mapa de lugares",t="Busca un lugar y seleccionalo para agregarlo a la lista. Puedes ver la informaci\xf3n del lugar, y asignarle un color. Agrupa los lugares que quieres visitar en el mismo d\xeda en un mismo color. Esto te servir\xe1 para planear el itinerario.",Object(m.jsx)(ie.a,{placement:"right",overlay:Object(m.jsxs)(ce.a,{id:"popover-basic",children:[Object(m.jsx)(ce.a.Header,{as:"h3",children:e}),Object(m.jsx)(ce.a.Body,{children:t})]}),children:Object(m.jsx)("button",{type:"button",style:{backgroundColor:"white",borderStyle:"none",paddingTop:"5px"},children:Object(m.jsx)(le.e,{color:"grey",size:"1.5em"})})}))}),Object(m.jsx)("div",{id:"second",children:Object(m.jsxs)("select",{className:"form-select","aria-label":"Default select example",value:this.state.value,onChange:function(e){return a.sortPlaces(e)},style:{display:"inline-block"},children:[Object(m.jsx)("option",{value:"1",children:"Ordenar por color"}),Object(m.jsx)("option",{value:"2",children:"Ordenar por nombre"})]})}),Object(m.jsx)("div",{id:"clear"})]})}),Object(m.jsx)(U.a,{xs:6,lg:5,children:Object(m.jsx)("button",{type:"button",className:"btn btn-danger float-right",onClick:this.resetColors,children:"Reiniciar colores"})})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)(se.a,{defaultActiveKey:this.state.activeKey,style:{maxHeight:"80vh",overflowY:"scroll"},children:this.state.myPlaces.map((function(e,t){return Object(m.jsxs)(se.a.Item,{eventKey:t.toString(),id:e.id,children:[Object(m.jsxs)(se.a.Header,{children:[Object(m.jsx)("img",{width:"30",src:e.detail.icon,height:"30",className:"d-inline-block align-top",alt:""}),Object(m.jsx)("span",{className:"accordion-pad",style:{textDecorationLine:void 0===e.colorCode?"none":"underline",textDecorationColor:void 0===e.colorCode?"":e.colorCode,textDecorationThickness:void 0===e.colorCode?"":"3px"},children:e.name})]}),Object(m.jsx)(se.a.Body,{children:Object(m.jsxs)(V.a,{children:[Object(m.jsxs)(V.a.Header,{style:{backgroundColor:void 0===e.colorCode?"":e.colorCode,color:"black"},children:[Object(m.jsxs)(S.a,{variant:"info",className:"float-left",onClick:function(t){return a.centerMarker(t,e.location)},children:[Object(m.jsx)(oe.a,{})," Ver en el mapa"]}),Object(m.jsx)(S.a,{variant:"danger",className:"float-right",onClick:function(t){return a.deletePlace(t,e.id)},children:Object(m.jsx)(le.j,{})})]}),Object(m.jsxs)(ne.a,{children:[Object(m.jsxs)(ne.a.Item,{children:[Object(m.jsx)(le.b,{className:"pad-icon"}),e.detail.formatted_address]}),Object(m.jsx)(ne.a.Item,{children:Object(m.jsxs)("div",{className:"btn-group",style:{width:"100%"},children:[Object(m.jsxs)("button",{type:"button",className:"btn btn-outline-info col-12 dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:[Object(m.jsx)(le.f,{className:"pad-icon"}),"Horas de apertura"]}),Object(m.jsx)("div",{className:"dropdown-menu",children:void 0!==e.detail.opening_hours?e.detail.opening_hours.weekday_text.map((function(e){return Object(m.jsx)("span",{className:"dropdown-item",href:"#",children:e},e)})):"-"})]})}),Object(m.jsxs)(ne.a.Item,{children:[Object(m.jsx)(le.a,{className:"pad-icon"}),Object(m.jsx)("a",{href:e.detail.website,target:"_blank",rel:"noreferrer",children:"Visitar URL"})]})]}),Object(m.jsx)(V.a.Footer,{children:Object(m.jsx)("div",{className:"circlecontainer",children:Object(m.jsx)("div",{className:"child",children:Object(m.jsx)(re.a,{onChange:function(t){return a.handleChangeComplete(t,e.id)},color:e.colorCode,colors:ue.slice(0,a.props.numOfDays)})})})})]})})]},t)}))}),0===this.state.myPlaces.length?"Empieza buscando lugares que quieras visitar en este viaje":""]})]})]})})}}]),a}(n.a.Component),be=a(28),me=a.n(be),Oe=A().store,xe=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).state={center:{lat:37.7824134,lng:-122.4088472},zoom:13,tripId:Oe.getState().trip.selectedTrip.id,numOfDays:3,country:""},s.recenterMap=s.recenterMap.bind(Object(ee.a)(s)),s}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=Oe.getState().trip.selectedTrip;if(void 0!==e){this.setState({trip:e}),this.setState({center:{lat:parseFloat(e.selectedCity.split(",")[1]),lng:parseFloat(e.selectedCity.split(",")[2])}}),this.setState({tripId:e.id});var t=me()(e.calendar.startDate),a=me()(e.calendar.endDate).diff(t,"days")+1;this.setState({numOfDays:a}),this.setState({country:e.selectedCountry.toUpperCase()})}else this.props.history.push("/plan")}},{key:"recenterMap",value:function(e){this.state.center!==e&&(console.log("dif"),this.setState({center:e}),this.setState({zoom:16}))}},{key:"render",value:function(){var e=this.state.center;return Object(m.jsxs)("div",{className:"container-fluid",children:[Object(m.jsx)("div",{className:"row",id:"banner",children:Object(m.jsx)("div",{className:"col-2 col-offset-0",children:Object(m.jsx)(M,{showLinks:!0,history:this.props.history})})}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("div",{className:"color",children:Object(m.jsxs)("ol",{className:"breadcrumb",children:[Object(m.jsx)("li",{className:"breadcrumb-item",children:Object(m.jsx)("a",{href:"/",children:"Inicio"})}),Object(m.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:"Mapa"})]})}),Object(m.jsx)("div",{children:Object(m.jsx)(pe,{center:e,zoom:this.state.zoom,tripId:this.state.tripId,numOfDays:this.state.numOfDays,onChange:this.recenterMap,country:this.state.country})})]})}}]),a}(n.a.Component),ve=a(264),fe=a.n(ve),ge=(a(429),a(237),function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).hideModal=function(){var e=s.fullname.value,t=s.phone.value;s.props.onSave({fullname:e,phone:t})},s.handleRemove=function(){s.props.onRemove()},s.handleSave=function(){if(s.handleValidation()){var e=s.fullname.value,t=s.phone.value,a=s.state.startDate,n=s.state.endDate,r=!1,i=[],c=s.hexToRgb(s.props.placeToSchedule.colorCode),l=s.props.placeToSchedule.id;if(i.push({fromSchedule:true,start:a,end:n,fullname:e,phone:t,isMovement:r,color:c,placeId:l}),s.state.includeTime){var o=parseInt(s.props.placeToSchedule.duration.split(" ")[0]),d={fromSchedule:true,start:a.clone().subtract(o,"minutes"),end:a,isMovement:r=!0};i.push(d)}s.props.onSave(i)}else alert("Form has errors.")},s.handleClose=function(){s.props.onModalClose()},s.handleStartDateChange=function(e){s.setState({startHour:e.target.value});var t=me()(s.props.start.format("yyyy-MM-DD")+" "+e.target.value);if(s.setState({startDate:t}),void 0!==s.state.endDate){var a=s.state.endDate.diff(t,"minutes")/60;s.setState({duration:me()(a)+" hora(s)"})}},s.handleEndDateChange=function(e){s.setState({endHour:e.target.value});var t=me()(s.props.start.format("yyyy-MM-DD")+" "+e.target.value);if(s.setState({endDate:t}),void 0!==s.state.startDate){var a=t.diff(s.state.startDate,"minutes")/60;s.setState({duration:me()(a)+" hora(s)"})}},s.handleCheckbox=function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value;s.setState({includeTime:a})},s.state={show:!0,startDate:void 0,endDate:void 0,duration:"-",invalidData:!0,errors:{},includeTime:!1,startHour:s.props.minimumHour,endHour:s.props.minimumHour,lastHour:s.props.minimumHour},s}return Object(v.a)(a,[{key:"componentWillUpdate",value:function(e,t){t.invalidData=!(t.startDate&&t.endDate)}},{key:"componentWillReceiveProps",value:function(e){if(e.minimumHour!==this.state.lastHour){var t=me()(e.start.format("yyyy-MM-DD")+" "+e.minimumHour);this.setState({startDate:t});var a=me()(e.start.format("yyyy-MM-DD")+" "+e.minimumHour).add(1,"hours");this.setState({endDate:a}),this.setState({lastHour:e.minimumHour}),this.setState({startHour:e.minimumHour}),this.setState({endHour:a.format("HH:mm")}),this.setState({duration:"1 hora"})}}},{key:"handleValidation",value:function(){var e={},t=!0;return this.state.endDate<=this.state.startDate&&(t=!1,e.endDate="La fecha de fin debe ser mayor que la fecha de inicio"),this.setState({errors:e}),t}},{key:"hexToRgb",value:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}},{key:"render",value:function(){var e=this,t=this.props,a=t.phone,s=t.start,n=void 0!==this.props.start?0===this.props.start.day()?6:this.props.start.day()-1:"1",r=void 0!==this.props.placeToSchedule?this.props.placeToSchedule.opHours.weekday_text[parseInt(n)]:"-";return Object(m.jsxs)(w.a,{style:{minWidth:"500px"},show:this.props.show,children:[Object(m.jsx)(w.a.Header,{children:Object(m.jsx)(w.a.Title,{children:"Planear visita"})}),Object(m.jsxs)(w.a.Body,{children:[Object(m.jsxs)("div",{className:"form-group row",children:[Object(m.jsx)("label",{className:"col-sm-4 col-form-label",children:"Hora de apertura"}),Object(m.jsx)("div",{className:"col-sm-8",children:Object(m.jsx)("input",{type:"text",readOnly:!0,className:"form-control",value:r,disabled:!0})})]}),Object(m.jsxs)("div",{className:"form-group row",children:[Object(m.jsx)("label",{className:"col-sm-2 col-form-label",children:"Fecha"}),Object(m.jsx)("div",{className:"col-sm-4",children:Object(m.jsx)("input",{type:"text",readOnly:!0,className:"form-control",value:s.format("DD/MM/yyyy"),disabled:!0})}),Object(m.jsx)("label",{className:"col-sm-2 col-form-label",children:"Inicio"}),Object(m.jsxs)("div",{className:"col-sm-4",children:[Object(m.jsx)("input",{type:"time",className:"appt",name:"appt",required:!0,onChange:function(t){return e.handleStartDateChange(t)},value:this.state.startHour}),Object(m.jsx)("span",{className:"error",style:{color:"red"},children:this.state.errors.startDate})]})]}),Object(m.jsxs)("div",{className:"form-group row",children:[Object(m.jsx)("label",{className:"col-sm-2 col-form-label",children:"Fin"}),Object(m.jsxs)("div",{className:"col-sm-4",children:[Object(m.jsx)("input",{type:"time",className:"appt",name:"appt",required:!0,onChange:function(t){return e.handleEndDateChange(t)},value:this.state.endHour}),Object(m.jsx)("span",{className:"error",style:{color:"red"},children:this.state.errors.endDate})]}),Object(m.jsx)("label",{className:"col-sm-2 col-form-label",children:"Duraci\xf3n"}),Object(m.jsx)("div",{className:"col-sm-4",children:Object(m.jsx)("input",{type:"text",readOnly:!0,className:"form-control",value:this.state.duration,disabled:!0})})]}),Object(m.jsxs)("div",{className:"form-group row",children:[Object(m.jsx)("label",{className:"col-sm-2 col-form-label",children:"Lugar"}),Object(m.jsx)("div",{className:"col-sm-10",children:Object(m.jsx)("input",{type:"text",readOnly:!0,ref:function(t){return e.fullname=t},className:"form-control",value:void 0!==this.props.placeToSchedule?this.props.placeToSchedule.name:"",disabled:!0})})]}),Object(m.jsxs)("div",{className:"form-group row",children:[Object(m.jsx)("label",{className:"col-sm-2 col-form-label",children:"Detalle"}),Object(m.jsx)("div",{className:"col-sm-10",children:Object(m.jsx)("input",{ref:function(t){return e.phone=t},className:"form-control",type:"text",placeholder:"Ingrese informaci\xf3n adicional para la visita",defaultValue:a,id:"usr2"})})]}),Object(m.jsx)("div",{className:"form-group",children:Object(m.jsxs)("div",{className:"form-check center",children:[Object(m.jsx)("input",{className:"form-check-input",type:"checkbox",checked:this.state.includeTime,onChange:this.handleCheckbox}),Object(m.jsxs)("label",{className:"form-check-label",children:["Incluir trayecto desde ",void 0!==this.props.parentOfPlace?this.props.parentOfPlace.name:""," (",void 0!==this.props.placeToSchedule?this.props.placeToSchedule.duration:" ",")"]})]})})]}),Object(m.jsxs)(w.a.Footer,{children:[Object(m.jsx)(S.a,{variant:"secondary",onClick:this.handleClose,children:"Close"}),Object(m.jsx)(S.a,{variant:"primary",onClick:this.handleSave,disabled:this.state.invalidData,children:"Guardar"})]})]})}}]),a}(n.a.Component)),ye=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;Object(x.a)(this,a),(s=t.call(this,e)).handleRemove=function(){s.props.onRemove()},s.hideModal=function(){var e=s.fullname.value,t=s.phone.value;s.props.onSave({fullname:e,phone:t})},s.handleRemove=function(){s.props.onRemove()},s.handleSave=function(){if(s.handleValidation()){var e=s.fullname.value,t=s.phone.value,a=s.state.startDate,n=s.state.endDate;void 0!==s.props.uid?s.props.onSave({fullname:e,phone:t,uid:s.props.uid,start:a,end:n}):s.props.onSave({fullname:e,phone:t,start:a,end:n})}},s.handleStartDateChange=function(e){s.setState({startHour:e.target.value});var t=me()(s.props.start.format("yyyy-MM-DD")+" "+e.target.value);if(s.setState({startDate:t}),void 0!==s.state.endDate){var a=(s.state.endDate.diff(t,"minutes")/60).toFixed(1);s.setState({duration:a+" hora(s)"})}},s.handleEndDateChange=function(e){s.setState({endHour:e.target.value});var t=me()(s.props.start.format("yyyy-MM-DD")+" "+e.target.value);if(s.setState({endDate:t}),void 0!==s.state.startDate){var a=(t.diff(s.state.startDate,"minutes")/60).toFixed(1);s.setState({duration:a+" hora(s)"})}};var n=(s.props.end.diff(s.props.start,"minutes")/60).toFixed(1);return s.state={startDate:s.props.start,endDate:s.props.end,startHour:s.props.start.format("HH:mm"),endHour:s.props.end.format("HH:mm"),duration:n+" hora(s)",errors:{}},s}return Object(v.a)(a,[{key:"handleValidation",value:function(){var e={},t=!0;return this.state.endDate<=this.state.startDate&&(t=!1,e.endDate="La fecha de fin debe ser mayor que la fecha de inicio"),this.setState({errors:e}),t}},{key:"render",value:function(){var e=this,t=this.props,a=t.fullname,s=t.phone,n=t.start,r=t.end,i=t.actionType,c="create"===i?"Agendar":"Actualizar";return Object(m.jsxs)(w.a.Dialog,{style:{minWidth:"500px"},children:[Object(m.jsx)(w.a.Header,{children:Object(m.jsx)(w.a.Title,{children:"Planear visita"})}),Object(m.jsxs)(w.a.Body,{children:[Object(m.jsxs)("div",{className:"form-group row",children:[Object(m.jsx)("label",{className:"col-sm-2 col-form-label",children:"Fecha"}),Object(m.jsx)("div",{className:"col-sm-4",children:Object(m.jsx)("input",{type:"text",readOnly:!0,className:"form-control",value:n.format("DD/MM/yyyy"),disabled:!0})}),Object(m.jsx)("label",{className:"col-sm-2 col-form-label",children:"Inicio"}),Object(m.jsx)("div",{className:"col-sm-4",children:"create"===i?Object(m.jsx)("input",{type:"text",readOnly:!0,className:"form-control",value:n.format("hh:mm a"),disabled:!0}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("input",{type:"time",className:"appt",name:"appt",required:!0,onChange:function(t){return e.handleStartDateChange(t)},value:this.state.startHour}),Object(m.jsx)("span",{className:"error",style:{color:"red"},children:this.state.errors.startDate})]})})]}),Object(m.jsxs)("div",{className:"form-group row",children:[Object(m.jsx)("label",{className:"col-sm-2 col-form-label",children:"Fin"}),Object(m.jsx)("div",{className:"col-sm-4",children:"create"===i?Object(m.jsx)("input",{type:"text",readOnly:!0,className:"form-control",value:r.format("hh:mm a"),disabled:!0}):Object(m.jsxs)(m.Fragment,{children:[" ",Object(m.jsx)("input",{type:"time",className:"appt",name:"appt",required:!0,onChange:function(t){return e.handleEndDateChange(t)},value:this.state.endHour}),Object(m.jsx)("span",{className:"error",style:{color:"red"},children:this.state.errors.endDate})]})}),Object(m.jsx)("label",{className:"col-sm-2 col-form-label",children:"Duraci\xf3n"}),Object(m.jsx)("div",{className:"col-sm-4",children:Object(m.jsx)("input",{type:"text",readOnly:!0,className:"form-control",value:this.state.duration,disabled:!0})})]}),Object(m.jsxs)("div",{className:"form-group row",children:[Object(m.jsx)("label",{className:"col-sm-2 col-form-label",children:"Lugar"}),Object(m.jsx)("div",{className:"col-sm-10",children:Object(m.jsx)("input",{ref:function(t){return e.fullname=t},className:"form-control",type:"text",placeholder:"Full name",defaultValue:a,id:"usr"})})]}),Object(m.jsxs)("div",{className:"form-group row",children:[Object(m.jsx)("label",{className:"col-sm-2 col-form-label",children:"Detalle"}),Object(m.jsx)("div",{className:"col-sm-10",children:Object(m.jsx)("input",{ref:function(t){return e.phone=t},className:"form-control",type:"text",placeholder:"Ingrese informaci\xf3n adicional para la visita",defaultValue:s,id:"usr2"})})]})]}),Object(m.jsxs)(w.a.Footer,{children:[Object(m.jsx)(S.a,{variant:"danger",onClick:this.handleRemove,children:"Borrar"}),Object(m.jsx)(S.a,{variant:"primary",onClick:this.handleSave,children:c})]})]})}}]),a}(n.a.Component),Se=a(20),Ce=a.p+"static/media/subway-solid.5f37c109.svg",Ne=function(e){var t=e.isMovement,a=e.color;if(void 0!==t&&t)return Object(m.jsxs)("div",{className:"evento center",style:{backgroundColor:"rgb(57,111,158,.6)"},children:[Object(m.jsx)("img",{width:"20",src:Ce,height:"20",alt:"",className:"pad-icon"}),Object(m.jsx)("span",{children:"".concat(e.start.format("HH:mm")," - ").concat(e.end.format("HH:mm"))})]});if(void 0!==a){var s=a.r+","+a.g+","+a.b+",.4 ";return Object(m.jsxs)("div",{className:"evento",style:{backgroundColor:"rgb("+s+")"},children:[Object(m.jsx)("span",{children:"".concat(e.start.format("HH:mm")," - ").concat(e.end.format("HH:mm"))}),Object(m.jsx)("br",{}),e.value]})}return Object(m.jsxs)("div",{className:"evento",style:{backgroundColor:"rgb(139,195,74,.4)"},children:[Object(m.jsx)("span",{children:"".concat(e.start.format("HH:mm")," - ").concat(e.end.format("HH:mm"))}),Object(m.jsx)("br",{}),e.value]})},ke=a(43),De=function(e){return Object(m.jsx)(ie.a,{placement:"bottom",delay:{show:250,hide:200},overlay:Object(m.jsx)(ke.a,{children:e}),children:Object(m.jsx)("button",{type:"button",style:{backgroundColor:"white",borderStyle:"none"},children:Object(m.jsx)(le.e,{color:"grey",size:"1.3em"})})})},we=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).handleSave=function(){s.handleValidation()&&s.props.onSave({unit:s.unit.value,calendarStart:s.state.startHour})},s.handleClose=function(){s.props.onModalClose()},s.handleStartDateChange=function(e){s.setState({startHour:e.target.value})},s.state={errors:{},startHour:s.props.minimumHour},s}return Object(v.a)(a,[{key:"handleValidation",value:function(){var e={},t=!0;return""===this.unit.value?(t=!1,e.unit="Ingrese una unidad para el calendario"):(parseInt(this.unit.value)<1||parseInt(this.unit.value)>60)&&(t=!1,e.unit="Ingrese una unidad entre 1 y 120"),this.setState({errors:e}),t}},{key:"render",value:function(){var e=this;return Object(m.jsxs)(w.a,{show:this.props.show,onHide:this.handleClose,backdrop:"static",keyboard:!1,children:[Object(m.jsx)(w.a.Header,{closeButton:!0,children:Object(m.jsx)(w.a.Title,{children:"Configuraciones del calendario"})}),Object(m.jsx)(w.a.Body,{children:Object(m.jsxs)(Se.a,{children:[Object(m.jsxs)(Se.a.Group,{className:"mb-3",children:[Object(m.jsxs)(Se.a.Label,{children:[De("Cantidad de minutos que representan un cuadro en el calendario."),"Unidad del calendario"]}),Object(m.jsx)(Se.a.Control,{type:"number",placeholder:"Ingrese un valor de 1 a 60",ref:function(t){return e.unit=t},defaultValue:this.props.unit}),Object(m.jsx)("span",{className:"error",style:{color:"red"},children:this.state.errors.unit})]}),Object(m.jsxs)(Se.a.Group,{className:"mb-3",children:[Object(m.jsxs)(Se.a.Label,{children:[De("El calendario se mostrar\xe1 desde esta hora."),"Hora de inicio del calendario"]}),Object(m.jsx)("input",{type:"time",className:"appt",name:"appt",onChange:function(t){return e.handleStartDateChange(t)},value:this.state.startHour})]})]})}),Object(m.jsxs)(w.a.Footer,{children:[Object(m.jsx)(S.a,{variant:"secondary",onClick:this.handleClose,children:"Cerrar"}),Object(m.jsx)(S.a,{variant:"primary",onClick:this.handleSave,children:"Guardar"})]})]})}}]),a}(n.a.Component),Ie=function(e){return Object(m.jsx)(ie.a,{placement:"bottom",delay:{show:250,hide:200},overlay:Object(m.jsx)(ke.a,{children:e}),children:Object(m.jsx)("button",{type:"button",style:{backgroundColor:"white",borderStyle:"none"},children:Object(m.jsx)(le.e,{color:"grey",size:"1.3em"})})})},Me=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).handleEventRemove=function(e){var t=s.state.selectedIntervals,a=t.findIndex((function(t){return t.uid===e.uid}));a>-1&&(t.splice(a,1),s.setState({selectedIntervals:t})),G.a.delete("http://localhost:5000/events/"+s.props.tripId+"/"+e.uid).then((function(e){console.log("deleted event")}));var n=Object(te.a)(s.state.path);-1!==(a=n.findIndex((function(t){return t.id===e.placeId})))&&a===n.length-1&&(n[a].canSchedule=!0,n[a].scheduled=!1,s.setState({path:n}))},s.handleEventUpdate=function(e){var t=s.state.selectedIntervals,a=t.findIndex((function(t){return t.uid===e.uid}));a>-1&&(e.value=e.fullname+" - "+e.phone,t[a]=e,s.setState({selectedIntervals:t})),delete e._id,e.startString=e.start.format("yyyy-MM-DD HH:mm"),e.endString=e.end.format("yyyy-MM-DD HH:mm"),G.a.put("http://localhost:5000/events/"+s.props.tripId+"/"+e.uid,e).then((function(e){console.log("updated event")}))},s.handleSelect=function(e){console.log(e);var t=s.state,a=t.lastUid,n=t.selectedIntervals,r=e.map((function(e,t){var n="";return void 0!==e.fullname&&(n+=e.fullname),void 0!==e.phone&&(n+=""===n?e.phone:" - "+e.phone),Object(u.a)(Object(u.a)({},e),{},{uid:a+t,value:n,isMovement:e.isMovement,color:e.color,tripId:s.props.tripId,startString:e.start.format("yyyy-MM-DD HH:mm"),endString:e.end.format("yyyy-MM-DD HH:mm")})})),i=s.state.minimumHour,c="";if(e.forEach((function(e){if(void 0!==e.placeId&&(c=e.placeId),e.end.format("dddd - DD/MM/YYYY")===s.state.colorDate){var t=e.end.format("HH:mm").split(":"),a=i.split(":"),n=parseInt(t[0]),r=parseInt(a[0]),l=parseInt(t[1]),o=parseInt(a[1]);if(n>r||n===r&&l>o){var d=e.end.format("HH:mm");i=d}}})),s.setState({minimumHour:i}),""!==c){var l=Object(te.a)(s.state.path),o=l.findIndex((function(e){return e.id===c}));-1!==o&&(l[o].canSchedule=!1,l[o].scheduled=!0,s.setState({addedDelta:!1}),o+1<l.length&&(l[o+1].canSchedule=!0))}G.a.post("http://localhost:5000/events",r).then((function(e){console.log("savedSchedule")})),s.setState({selectedIntervals:n.concat(r),lastUid:a+e.length}),s.setState({showModal:!1})},s.onModalClose=function(e){s.setState({showModal:!1})},s.onCalendarModalClose=function(e){s.setState({showCalendarModal:!1})},s.openCalendarModal=function(){s.setState({showCalendarModal:!0})},s.handleCalendarSave=function(e){var t={h:parseInt(e.calendarStart.split(":")[0]),m:parseInt(e.calendarStart.split(":")[1])};s.setState({showCalendarModal:!1,unit:e.unit,calendarStart:t}),s.patchTripCalendar({unit:e.unit,calendarStart:t})},s.handleChangeComplete=function(e){var t=e.hex;s.setState({background:t});var a=Object(te.a)(s.state.myPlaces),n=[];if(n="#000000"===t?a.filter((function(e){return void 0===e.colorCode})):a.filter((function(e){return e.colorCode===t})),""!==s.state.hotel){var r=n.findIndex((function(e){return e.id===s.state.hotel})),i=null;-1!==r?(i=n[r],n.splice(r,1)):(r=a.findIndex((function(e){return e.id===s.state.hotel})),i=a[r]);var c=Object(te.a)(s.state.path);0===(c=[]).length&&(i.durationValue=0,c.push(i),s.setState({path:c})),s.setState({origin:i}),n.length>0?s.computeDistances(i,n):s.setState({colorPlaces:[]})}},s.handleHotelSelection=function(e){var t=e.target.value;if(""!==t&&t!==s.state.hotel){s.setState({hotel:e.target.value});var a={id:s.props.tripId,placeId:e.target.value};""===s.state.hotel?G.a.post("http://localhost:5000/hotels",a).then((function(e){console.log("savedHotel")})):G.a.put("http://localhost:5000/hotels/"+s.props.tripId,a).then((function(e){console.log("updatedHotel")}))}},s.placeSelected=function(e,t){var a=Object(te.a)(s.state.colorPlaces),n=a.findIndex((function(e){return e.id===t.id}));a.splice(n,1),s.setState({colorPlaces:a});var r=t.detail.opening_hours;t.opHours=r,s.setState({origin:t}),a.length>0&&s.computeDistances(t,a);var i=Object(te.a)(s.state.path);-1===Object(te.a)(s.state.selectedIntervals).findIndex((function(e){return e.placeId===t.id}))?(1===i.length||0===s.computePlacesToSchedule()?t.canSchedule=!0:t.canSchedule=!1,t.scheduled=!1):(t.canSchedule=!1,t.scheduled=!0),i.push(t),s.setState({path:i})},s.computePlacesToSchedule=function(){return Object(te.a)(s.state.path).filter((function(e){return!1===e.scheduled})).length},s.handleModeChange=function(e){s.setState({transportMode:e.target.value})},s.handleDateChange=function(e){s.setState({colorDate:e.target.value});var t=me()(e.target.value.split("-")[1].trim(),"DD/MM/YYYY");s.setState({colorMoment:t})},s.handleDeleteFromPath=function(e,t){var a=Object(te.a)(s.state.path),n=a[a.length-2];(t.canSchedule||0===s.computePlacesToSchedule())&&(-1===Object(te.a)(s.state.selectedIntervals).findIndex((function(e){return e.placeId==a[a.length-2].id}))&&(a[a.length-2].canSchedule=!0));a.splice(a.length-1,1),s.setState({path:a});var r=Object(te.a)(s.state.colorPlaces);r.push(t),s.setState({colorPlaces:r}),s.setState({origin:n}),s.computeDistances(n,r)},s.scheduleVisit=function(e,t){var a=Object(te.a)(s.state.path),n=a.findIndex((function(e){return e.id===t.id}));if(s.setState({placeToSchedule:a[n]}),s.setState({parentOfPlace:a[n-1]}),s.setState({showModal:!0}),!s.state.addedDelta){var r=s.state.minimumHour,i=me()(s.state.colorMoment.format("yyyy-MM-DD")+" "+r),c=parseInt(a[n].duration.split(" ")[0]),l=i.add(c,"minutes").format("HH:mm");s.setState({minimumHour:l}),s.setState({addedDelta:!0})}},s.state={lastUid:1,selectedIntervals:[],myPlaces:[],colors:[],value:"0",background:"#000000",colorPlaces:[],hotel:"",transportMode:"transit",path:[],listOfDates:[],colorDate:"",colorMoment:me()(),origin:{},showModal:!1,pathSchedule:[],minimumHour:"06:00",addedDelta:!1,showCalendarModal:!1,minimumCalendarHour:"06:00",unit:30,calendarStart:{h:6,m:0}},s.handleEventRemove=s.handleEventRemove.bind(Object(ee.a)(s)),s.handleEventUpdate=s.handleEventUpdate.bind(Object(ee.a)(s)),s.handleSelect=s.handleSelect.bind(Object(ee.a)(s)),s.handleChangeComplete=s.handleChangeComplete.bind(Object(ee.a)(s)),s.placeSelected=s.placeSelected.bind(Object(ee.a)(s)),s.dynamicSort=s.dynamicSort.bind(Object(ee.a)(s)),s.handleHotelSelection=s.handleHotelSelection.bind(Object(ee.a)(s)),s.handleModeChange=s.handleModeChange.bind(Object(ee.a)(s)),s.computeDistances=s.computeDistances.bind(Object(ee.a)(s)),s.handleDateChange=s.handleDateChange.bind(Object(ee.a)(s)),s.handleDeleteFromPath=s.handleDeleteFromPath.bind(Object(ee.a)(s)),s.scheduleVisit=s.scheduleVisit.bind(Object(ee.a)(s)),s.onModalClose=s.onModalClose.bind(Object(ee.a)(s)),s.patchTripCalendar=s.patchTripCalendar.bind(Object(ee.a)(s)),s}return Object(v.a)(a,[{key:"patchTripCalendar",value:function(e){G.a.put("http://localhost:5000/hotels/"+this.props.tripId,e).then((function(e){console.log("updated calendar")}))}},{key:"componentDidMount",value:function(){var e=this;G.a.get("http://localhost:5000/places/"+this.props.tripId,{headers:{"Content-Type":"application/json"}}).then((function(t){var a=t.data;a.sort(e.dynamicSort("name")),e.setState({myPlaces:a});var s=Object(te.a)(new Set(a.map((function(e){return e.colorCode})))).map((function(e){return void 0!==e?e:"#000000"}));e.setState({colors:s});var n=[],r=e.props.firstDay;e.setState({colorMoment:r}),e.setState({colorDate:r.format("dddd - DD/MM/YYYY")});for(var i=r.clone().add(e.props.numOfDays-1,"d");r<=i;)n.push(r.format("dddd - DD/MM/YYYY")),r=r.clone().add(1,"d");e.setState({listOfDates:n})})),G.a.get("http://localhost:5000/events/"+this.props.tripId,{headers:{"Content-Type":"application/json"}}).then((function(t){var a=t.data,s=1;a.forEach((function(e){e.uid>s&&(s=e.uid),e.start=me()(e.startString),e.end=me()(e.endString)})),e.setState({selectedIntervals:a,lastUid:s+1})})),G.a.get("http://localhost:5000/hotels/"+this.props.tripId,{headers:{"Content-Type":"application/json"}}).then((function(t){var a=t.data;if(a.length>0){var s=void 0!==a[0].placeId?a[0].placeId:"",n=void 0!==a[0].unit?a[0].unit:e.state.unit,r=void 0!==a[0].calendarStart?a[0].calendarStart:e.state.calendarStart,i=e.state.minimumCalendarHour;if(void 0!==a[0].calendarStart){var c=a[0].calendarStart.h,l=a[0].calendarStart.m;i=(c>9?""+c:"0"+c)+":"+(l>9?""+l:"0"+l)}e.setState({hotel:s,unit:n,calendarStart:r,minimumCalendarHour:i})}else{var o={id:e.props.tripId,placeId:"",unit:e.state.unit,calendarStart:e.state.calendarStart};G.a.post("http://localhost:5000/hotels",o).then((function(e){}))}}))}},{key:"computeDistances",value:function(e,t){var a=this,s=e.location.lat+","+e.location.lng,n=[];t.forEach((function(e){n.push(e.location.lat+","+e.location.lng)}));var r={origins:s,destinations:n.join("|"),key:"AIzaSyDSymRKtpFQbaTLW8RovSLfZpjaD0WQow4",mode:this.state.transportMode};G.a.get("http://localhost:5000/matrix",{params:r},{headers:{"Content-Type":"application/json"}}).then((function(e){for(var s=e.data,n=0;n<s.length;n++)"OK"===s[n].result.status?(t[n].distance=s[n].result.distance.text,t[n].distanceValue=s[n].result.distance.value,t[n].duration=s[n].result.duration.text,t[n].durationValue=s[n].result.duration.value):t[n].duration="";t.sort(a.dynamicSort("distanceValue")),a.setState({colorPlaces:t})}))}},{key:"dynamicSort",value:function(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(a,s){var n=a[e],r=s[e];return void 0===n&&(n="zzzzzz"),void 0===r&&(r="zzzzzz"),(n<r?-1:n>r?1:0)*t}}},{key:"render",value:function(){var e=this;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(ge,{end:this.props.lastDay,start:this.state.colorMoment,show:this.state.showModal,onSave:this.handleSelect,onModalClose:this.onModalClose,placeToSchedule:this.state.placeToSchedule,parentOfPlace:this.state.parentOfPlace,minimumHour:this.state.minimumHour}),Object(m.jsx)(we,{show:this.state.showCalendarModal,onSave:this.handleCalendarSave,onModalClose:this.onCalendarModalClose,minimumHour:this.state.minimumCalendarHour,unit:this.state.unit},this.state.minimumCalendarHour),Object(m.jsx)("div",{className:"container-fluid",children:Object(m.jsxs)(Y.a,{children:[Object(m.jsxs)(U.a,{xs:12,xl:9,children:[Object(m.jsx)(Y.a,{children:Object(m.jsx)(fe.a,{dayFormat:"dd, DD/MM",firstDay:this.props.firstDay,numberOfDays:this.props.numOfDays,selectedIntervals:this.state.selectedIntervals,onIntervalSelect:this.handleSelect,onIntervalUpdate:this.handleEventUpdate,onIntervalRemove:this.handleEventRemove,scaleUnit:this.state.unit,modalComponent:ye,eventComponent:Ne,scaleFormat:"hh:mm a",startTime:me()({h:this.state.calendarStart.h,m:this.state.calendarStart.m})})}),Object(m.jsx)("br",{}),Object(m.jsx)(Y.a,{children:Object(m.jsxs)("div",{className:"ruta roboto",style:{fontSize:"13px"},children:[Object(m.jsx)("h1",{children:Object(m.jsxs)("span",{children:[Ie("En esta secci\xf3n se muestran en orden los lugares que vas a visitar en un d\xeda espec\xedfico. Puedes agregarlos al calendario teniendo en cuenta el tiempo de trayecto."),"Ruta (",this.state.colorDate,")"]})}),Object(m.jsxs)("p",{className:"duracion",children:[" ",this.state.path.length>1?"Tiempo total en trayectos: "+(this.state.path.reduce((function(e,t){return+e+ +t.durationValue}),0)/60).toFixed(2)+" minutos":""," "]}),Object(m.jsx)(ne.a,{horizontal:!0,style:{marginLeft:"20px",overflowX:"auto",whiteSpace:"nowrap",overflowY:"hidden"},children:this.state.path.map((function(t){return Object(m.jsx)(ne.a.Item,{style:{padding:"0",border:"none"},children:Object(m.jsxs)(ne.a,{children:[Object(m.jsxs)(ne.a.Item,{children:[t.id===e.state.hotel?"Hotel":t.name," \xa0",Object(m.jsx)("button",{type:"button",className:"btn btn-danger float-right","aria-label":"Close",style:{padding:"0 4px 0 4px",fontSize:"13px",marginLeft:"10px",display:t.id===e.state.hotel||t.id!==e.state.origin.id?"none":""},onClick:function(a){return e.handleDeleteFromPath(a,t)},children:"X"})]}),Object(m.jsxs)(ne.a.Item,{style:{display:void 0!==t.duration?"":"none"},children:["Trayecto: ",t.duration," - ",t.distance]}),Object(m.jsx)(ne.a.Item,{style:{display:t.id===e.state.hotel||t.canSchedule?"none":""},children:t.scheduled?Object(m.jsx)("p",{className:"center",style:{marginBottom:"0"},children:"Agendado"}):Object(m.jsx)("p",{children:t.detail.opening_hours.weekday_text[parseInt(0===e.state.colorMoment.day()?6:e.state.colorMoment.day()-1)]})}),Object(m.jsx)(ne.a.Item,{style:{display:t.id!==e.state.hotel&&t.canSchedule?"":"none"},children:Object(m.jsx)("button",{type:"button",className:"btn btn-success","aria-label":"Close",style:{padding:"0 4px 0 4px",fontSize:"13px",width:"100%"},onClick:function(a){return e.scheduleVisit(a,t)},children:"Agendar"})})]})},t.id)}))})]})})]}),Object(m.jsx)(U.a,{xs:12,xl:3,children:Object(m.jsxs)("div",{className:"div-border",children:[Object(m.jsxs)("h4",{children:["Crear una ruta",Object(m.jsx)("button",{type:"button",className:"float-right",style:{backgroundColor:"white",borderStyle:"none"},onClick:this.openCalendarModal,children:Object(m.jsx)(W.c,{className:"hover-button",color:"grey",size:"1.3em"})})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsxs)("label",{children:[Ie("Seleccione el lugar en el que se hospedar\xe1. Este ser\xe1 el punto de partida de cada d\xeda en la ruta."),"Hotel"]}),Object(m.jsxs)(Se.a.Select,{"aria-label":"Default select example",id:"hotel",onChange:function(t){return e.handleHotelSelection(t)},value:this.state.hotel,children:[Object(m.jsx)("option",{value:"",children:"Configura tu hotel"}),this.state.myPlaces.map((function(e){return Object(m.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsxs)("label",{children:[Ie("El tiempo de recorrido entre lugares se calcular\xe1 teniendo en cuenta el medio de transporte."),"Medio de transporte"]}),Object(m.jsxs)(Se.a.Select,{"aria-label":"Default select example",onChange:function(t){return e.handleModeChange(t)},value:this.state.transportMode,children:[Object(m.jsx)("option",{value:"driving",children:"Veh\xedculo"}),Object(m.jsx)("option",{value:"walking",children:"A pie"}),Object(m.jsx)("option",{value:"bicycling",children:"Bicicleta"}),Object(m.jsx)("option",{value:"transit",children:"Transporte p\xfablico"})]})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsxs)("label",{children:[Ie("Al seleccionar un lugar se muestran los lugares que agrup\xf3 por ese mismo color."),"Selecciona un color"]}),Object(m.jsx)(re.b,{id:"colors",width:"100%",colors:this.state.colors,color:this.state.background,onChange:function(t){return e.handleChangeComplete(t)}})]}),Object(m.jsxs)("div",{className:"form-group",children:[Object(m.jsxs)("label",{children:[Ie("Seleccione una fecha en la que desear\xeda visitar todos estos lugares. Al agregar los eventos al calendario, se pondr\xe1n en esa fecha."),"Asignar d\xeda para este color"]}),Object(m.jsx)(Se.a.Select,{"aria-label":"Default select example",onChange:function(t){return e.handleDateChange(t)},value:this.state.colorDate,children:this.state.listOfDates.map((function(e){return Object(m.jsx)("option",{value:e,children:e},e)}))})]}),Object(m.jsxs)("div",{className:"form-group",style:{display:this.state.colorPlaces.length>0?"":"none"},children:[Object(m.jsxs)("label",{children:[Ie("Seleccione el primer lugar a visitar. Las distancias y tiempos de recorrido se actualizar\xe1n teniendo como origen el lugar seleccionado. De esta manera puede planear su ruta acortando trayectos."),"Selecciona un lugar para agregar un lugar a la ruta"]}),Object(m.jsx)("div",{style:{overflowY:"scroll",height:"32vh",border:"1px solid"},children:Object(m.jsx)(ne.a,{id:"places",children:this.state.colorPlaces.map((function(t,a){return Object(m.jsxs)(ne.a.Item,{action:!0,style:{marginBottom:"1px"},onClick:function(a){return e.placeSelected(a,t)},children:[t.name," (",t.duration," - ",t.distance," desde ",e.state.origin.name," , horario de ",t.detail.opening_hours.weekday_text[parseInt(0===e.state.colorMoment.day()?6:e.state.colorMoment.day()-1)],")"]},a)}))})})]})]})})]})})]})}}]),a}(n.a.Component),Te=A().store,Le=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).state={tripId:"",startDate:new Date},s.renderCalendar=s.renderCalendar.bind(Object(ee.a)(s)),s}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=Te.getState().trip.selectedTrip;if(void 0!==e){this.setState({trip:e}),this.setState({tripId:e.id}),this.setState({startDate:e.calendar.startDate}),this.setState({endDate:e.calendar.endDate});var t=me()(e.calendar.startDate),a=me()(e.calendar.endDate).diff(t,"days")+1;this.setState({numOfDays:a})}else this.props.history.push("/plan")}},{key:"renderCalendar",value:function(){return Object(m.jsx)(Me,{firstDay:me()(this.state.startDate),lastDay:me()(this.state.endDate),numOfDays:this.state.numOfDays,tripId:this.state.tripId})}},{key:"render",value:function(){var e=this.state.numOfDays;return Object(m.jsxs)("div",{className:"container-fluid",children:[Object(m.jsx)("div",{className:"row",id:"banner",children:Object(m.jsx)("div",{className:"col-2 col-offset-0",children:Object(m.jsx)(M,{showLinks:!0,history:this.props.history})})}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("div",{className:"color",children:Object(m.jsxs)("ol",{className:"breadcrumb",children:[Object(m.jsx)("li",{className:"breadcrumb-item",children:Object(m.jsx)("a",{href:"/",children:"Inicio"})}),Object(m.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:"Itinerario"})]})}),Object(m.jsx)("div",{children:void 0!==e?this.renderCalendar():Object(m.jsx)("span",{children:"Cargando..."})})]})}}]),a}(n.a.Component),He=a(270),Pe=a(153),Ee=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).handleSave=function(){var e=s.name.value,t=s.description.value,a=s.price.value,n=s.quantity.value;if(s.handleValidation()){s.handleClose();var r={};void 0!==s.props.toEdit?(r={id:s.props.toEdit.id,name:e,price:a,description:t,quantity:n,ignore:s.props.toEdit.ignore},s.props.handleUpdate(r)):(r={name:e,price:a,description:t,quantity:n,ignore:!1},s.props.handleSave(r))}},s.handleShow=function(){s.props.handleShow(!0)},s.handleClose=function(){s.props.handleShow(!1)},s.state={errors:{}},s}return Object(v.a)(a,[{key:"handleValidation",value:function(){var e={},t=!0;return""===this.name.value&&(t=!1,e.name="Ingrese el nombre del elemento"),""===this.price.value?(t=!1,e.price="Ingrese el precio del elemento"):parseInt(this.price.value<=0)&&(t=!1,e.price="El precio debe ser un valor positivo"),""===this.quantity.value?(t=!1,e.quantity="Ingrese la cantidad del elemento"):parseInt(this.quantity.value<=0)&&(t=!1,e.quantity="La cantidad debe ser un valor positivo"),this.setState({errors:e}),t}},{key:"render",value:function(){var e=this;return Object(m.jsxs)(w.a,{show:this.props.show,onHide:this.handleClose,backdrop:"static",keyboard:!1,children:[Object(m.jsx)(w.a.Header,{closeButton:!0,children:Object(m.jsx)(w.a.Title,{children:"Agregar elemento al presupuesto"})}),Object(m.jsx)(w.a.Body,{children:Object(m.jsxs)(Se.a,{children:[Object(m.jsxs)(Se.a.Group,{className:"mb-3",children:[Object(m.jsx)(Se.a.Label,{children:"Nombre"}),Object(m.jsx)(Se.a.Control,{type:"text",placeholder:"Nombre del elemento",ref:function(t){return e.name=t},defaultValue:void 0!==this.props.toEdit?this.props.toEdit.name:"",maxLength:"30"}),Object(m.jsx)("span",{className:"error",style:{color:"red"},children:this.state.errors.name})]}),Object(m.jsxs)(Se.a.Group,{className:"mb-3",children:[Object(m.jsx)(Se.a.Label,{children:"Descripci\xf3n"}),Object(m.jsx)(Se.a.Control,{type:"text",placeholder:"Descripci\xf3n del elemento",ref:function(t){return e.description=t},defaultValue:void 0!==this.props.toEdit?this.props.toEdit.description:"",maxLength:"30"}),Object(m.jsx)("span",{className:"error",style:{color:"red"},children:this.state.errors.description})]}),Object(m.jsxs)(Se.a.Group,{className:"mb-3",children:[Object(m.jsx)(Se.a.Label,{children:"Precio"}),Object(m.jsx)(Se.a.Control,{type:"number",placeholder:"Precio del objeto",ref:function(t){return e.price=t},defaultValue:void 0!==this.props.toEdit?this.props.toEdit.price:"",min:"1",step:"any"}),Object(m.jsx)("span",{className:"error",style:{color:"red"},children:this.state.errors.price})]}),Object(m.jsxs)(Se.a.Group,{className:"mb-3",children:[Object(m.jsx)(Se.a.Label,{children:"Cantidad"}),Object(m.jsx)(Se.a.Control,{type:"number",placeholder:"Cantidad",ref:function(t){return e.quantity=t},defaultValue:void 0!==this.props.toEdit?this.props.toEdit.quantity:"",min:"1",step:"any"}),Object(m.jsx)("span",{className:"error",style:{color:"red"},children:this.state.errors.quantity})]})]})}),Object(m.jsxs)(w.a.Footer,{children:[Object(m.jsx)(S.a,{variant:"secondary",onClick:this.handleClose,children:"Close"}),Object(m.jsx)(S.a,{variant:"primary",onClick:this.handleSave,children:void 0!==this.props.toEdit?"Editar":"Agregar"})]})]})}}]),a}(n.a.Component),Be=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).handleClose=function(){s.props.handleShow(!1)},s.state={},s}return Object(v.a)(a,[{key:"render",value:function(){return Object(m.jsxs)(w.a,{show:this.props.showSaved,onHide:this.handleClose,backdrop:"static",keyboard:!1,children:[Object(m.jsx)(w.a.Header,{closeButton:!0,children:Object(m.jsx)(w.a.Title,{children:this.props.title})}),Object(m.jsx)(w.a.Body,{children:"Cambios guardados"}),Object(m.jsx)(w.a.Footer,{children:Object(m.jsx)(S.a,{variant:"primary",onClick:this.handleClose,children:"Ok"})})]})}}]),a}(n.a.Component),Fe=A().store,qe=function(e){return Object(m.jsx)(ie.a,{placement:"bottom",delay:{show:250,hide:200},overlay:Object(m.jsx)(ke.a,{children:e}),children:Object(m.jsx)("button",{type:"button",style:{backgroundColor:"white",borderStyle:"none"},children:Object(m.jsx)(le.e,{color:"grey",size:"1.3em"})})})},Re=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).componentDidUpdate=function(){s.state.shouldBlockNavigation?window.onbeforeunload=function(){return!0}:window.onbeforeunload=void 0},s.handleValChange=function(e){s.setState({val:parseInt(e.target.value),shouldBlockNavigation:!0})},s.handlCurrencyChange=function(e){parseInt(e.target.value)>0?s.setState({localCurrency:parseInt(e.target.value)}):s.setState({localCurrency:1}),s.setState({shouldBlockNavigation:!0})},s.handleEdit=function(e,t){var a=Object(te.a)(s.state.elements),n=a.findIndex((function(e){return e.id===t}));s.setState({toEdit:a[n],show:!0})},s.handleUpdate=function(e){e.total=parseInt(e.price)*parseInt(e.quantity);var t=Object(te.a)(s.state.elements),a=t.findIndex((function(t){return t.id===e.id}));t[a]=e;var n=t.filter((function(e){return!1===e.ignore})).reduce((function(e,t){return e+parseInt(t.total)}),0);s.setState({elements:t,toEdit:void 0,total:n}),s.setState({shouldBlockNavigation:!0})},s.handleIgnore=function(e,t){var a=Object(te.a)(s.state.elements),n=a.findIndex((function(e){return e.id===t}));a[n].ignore=!a[n].ignore;var r=a.filter((function(e){return!1===e.ignore})).reduce((function(e,t){return e+parseInt(t.total)}),0);s.setState({elements:a,total:r}),s.setState({shouldBlockNavigation:!0})},s.handleDelete=function(e,t){var a=Object(te.a)(s.state.elements),n=a.findIndex((function(e){return e.id===t})),r=a.filter((function(e){return!1===e.ignore})).reduce((function(e,t){return e+parseInt(t.total)}),0);a.splice(n,1),a.forEach((function(e,t){e.id=t})),0===a.length&&(r=0),s.setState({elements:a,total:r}),s.setState({shouldBlockNavigation:!0})},s.handleSave=function(e){var t=s.state.elements;e.total=parseInt(e.price)*parseInt(e.quantity),e.id=t.length,t.push(e);var a=t.filter((function(e){return!1===e.ignore})).reduce((function(e,t){return e+parseInt(t.total)}),0);s.setState({elements:t,total:a}),s.setState({shouldBlockNavigation:!0})},s.handleShow=function(e){s.setState({show:e,toEdit:void 0})},s.handleSaveChanges=function(){document.querySelectorAll(".tooltip").forEach((function(e){e.style.display="none"}));var e=s.state.trip.id,t={val:s.state.val,total:s.state.total,elements:s.state.elements,localCurrency:s.state.localCurrency};G.a.put("http://localhost:5000/budgets/"+e,t).then((function(e){console.log("updated budget"),s.setState({showSaved:!0}),s.setState({shouldBlockNavigation:!1})}))},s.handleClose=function(){s.setState({showSaved:!1})},s.state={val:5e3,total:2800,elements:[{id:1,name:"Comida",description:"Costo diario",price:100,quantity:10,total:1e3,ignore:!1},{id:2,name:"Entretenimiento",description:"Costo diario",price:40,quantity:10,total:400,ignore:!1},{id:3,name:"Hotel",description:"Habitaci\xf3n",price:1400,quantity:1,total:1400,ignore:!1}],show:!1,toEdit:void 0,trip:{},showSaved:!1,localCurrency:1,shouldBlockNavigation:!1},s}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=Fe.getState().trip.selectedTrip;void 0!==t?this.setState({trip:t}):this.props.history.push("/plan");var a=t.id;G.a.get("http://localhost:5000/budgets/"+a,{headers:{"Content-Type":"application/json"}}).then((function(t){var s=t.data;if(console.log(s),0===s.length){var n={tripId:a,val:e.state.val,total:e.state.total,elements:e.state.elements,localCurrency:e.state.localCurrency};G.a.post("http://localhost:5000/budgets",n).then((function(e){console.log("savedNewBudget")}))}else e.setState({val:s[0].val,total:s[0].total,elements:s[0].elements,localCurrency:s[0].localCurrency})}))}},{key:"render",value:function(){var e=this;return Object(m.jsxs)("div",{className:"container-fluid",children:[Object(m.jsx)("div",{className:"row",id:"banner",children:Object(m.jsx)("div",{className:"col-2 col-offset-0",children:Object(m.jsx)(M,{showLinks:!0,history:this.props.history})})}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("div",{className:"color",children:Object(m.jsxs)("ol",{className:"breadcrumb",children:[Object(m.jsx)("li",{className:"breadcrumb-item",children:Object(m.jsx)("a",{href:"/",children:"Inicio"})}),Object(m.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:"Presupuesto"})]})}),Object(m.jsx)(d.a,{when:this.state.shouldBlockNavigation,message:"Hay cambios sin guardar. \xbfDesea salir sin guardarlos?"}),Object(m.jsx)(Ee,{show:this.state.show,handleSave:this.handleSave,handleShow:this.handleShow,toEdit:this.state.toEdit,handleUpdate:this.handleUpdate}),Object(m.jsx)(Be,{title:"Presupuesto",showSaved:this.state.showSaved,handleShow:this.handleClose}),Object(m.jsxs)("div",{className:"pcontainer container-fluid",children:[Object(m.jsxs)(Se.a,{style:{paddingTop:"10px"},children:[Object(m.jsxs)(Se.a.Group,{as:Y.a,className:"mb-3",controlId:"formPlaintextPassword",children:[Object(m.jsxs)(Se.a.Label,{column:!0,xs:6,md:"2",children:[qe("Ingrese un estimado de lo que planea gastar en el viaje. El avance se calcula con respecto a esto."),"Presupuesto objetivo"]}),Object(m.jsx)(U.a,{xs:6,md:"2",children:Object(m.jsx)(Se.a.Control,{type:"number",placeholder:"$ Ingrese el presupuesto inicial",value:this.state.val,onChange:this.handleValChange})}),Object(m.jsx)(U.a,{xs:12,md:"8",children:Object(m.jsx)(ie.a,{placement:"bottom",delay:{show:250,hide:200},overlay:Object(m.jsx)(ke.a,{children:"Porcentaje del presupuesto objetivo gastado."}),children:Object(m.jsx)(He.a,{animated:!0,now:0===this.state.val?50:this.state.total/this.state.val*100,label:0===this.state.val?"Porcentaje gastado del presupuesto":"".concat((this.state.total/this.state.val*100).toFixed(2),"%"),style:{height:"38px"}})})})]}),Object(m.jsxs)(Se.a.Group,{as:Y.a,className:"mb-3",controlId:"formPlaintextPassword",children:[Object(m.jsxs)(Se.a.Label,{column:!0,xs:6,md:"2",children:[qe("Suma de los costos totales de los elementos en la tabla."),"Costo total del viaje"]}),Object(m.jsx)(U.a,{xs:6,md:"2",children:Object(m.jsx)(Se.a.Control,{plaintext:!0,readOnly:!0,value:"$"+this.state.total.toLocaleString()})}),Object(m.jsxs)(Se.a.Label,{column:!0,xs:6,md:"2",children:[qe("Si ingres\xf3 la tabla en una moneda extranjera, puede ingresar aqu\xed a cuanto equivale una (1) unidad en su moneda local. (Por ejemplo ingrese 30 si la tabla est\xe1 en d\xf3lares y 1 dolar equivale a 30 en su moneda local)"),"Convertir a moneda local"]}),Object(m.jsx)(U.a,{xs:6,md:"2",children:Object(m.jsx)(Se.a.Control,{type:"number",placeholder:"$ Ingrese el valor de conversi\xf3n",value:this.state.localCurrency,onChange:this.handlCurrencyChange})}),Object(m.jsx)(Se.a.Label,{column:!0,xs:6,md:"2",children:"Costo total en moneda local"}),Object(m.jsx)(U.a,{xs:6,md:"2",children:Object(m.jsx)(Se.a.Control,{plaintext:!0,readOnly:!0,value:"$"+(this.state.total*this.state.localCurrency).toLocaleString()})})]})]}),Object(m.jsx)("hr",{}),Object(m.jsxs)(Se.a.Group,{as:Y.a,className:"mb-3",controlId:"formPlaintextPassword",children:[Object(m.jsxs)(Se.a.Label,{column:!0,xs:2,md:"2",children:[qe("Dinero que queda del presupuesto objetivo."),"Dinero restante"]}),Object(m.jsx)(U.a,{xs:2,md:"2",children:Object(m.jsx)(Se.a.Control,{plaintext:!0,readOnly:!0,value:"$"+(this.state.val-this.state.total).toLocaleString()})}),Object(m.jsx)(U.a,{xs:8,md:"8",children:Object(m.jsxs)("div",{className:"inline float-right",children:[Object(m.jsx)(ie.a,{placement:"bottom",delay:{show:250,hide:200},overlay:Object(m.jsx)(ke.a,{children:"Guardar la tabla. Si no se guarda, se descartar\xe1n los cambios al salir de la pesta\xf1a."}),children:Object(m.jsxs)(S.a,{variant:"success",className:"inline",onClick:this.handleSaveChanges,disabled:!this.state.shouldBlockNavigation,children:[Object(m.jsx)(le.i,{style:{marginRight:"10px"}}),"Guardar cambios"]})}),Object(m.jsx)(ie.a,{placement:"bottom",delay:{show:250,hide:200},overlay:Object(m.jsx)(ke.a,{children:"Agregar un elemento a la tabla."}),children:Object(m.jsxs)(S.a,{variant:"primary",className:"inline float-right",onClick:this.handleShow,children:[Object(m.jsx)(le.d,{style:{marginRight:"10px"}}),"Agregar elemento"]})})]})})]}),Object(m.jsxs)(Pe.a,{striped:!0,bordered:!0,hover:!0,children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{children:"Elemento"}),Object(m.jsx)("th",{children:"Descripci\xf3n"}),Object(m.jsx)("th",{children:"Costo"}),Object(m.jsx)("th",{children:"Cantidad"}),Object(m.jsx)("th",{children:"Total"}),Object(m.jsxs)("th",{children:[qe("Puede editar el elemento, ignorar el elemento (para no tenerlo en cuenta en el total) o eliminarlo de la tabla."),"Acciones"]})]})}),Object(m.jsx)("tbody",{children:this.state.elements.map((function(t,a){return Object(m.jsxs)("tr",{style:{backgroundColor:t.ignore?"grey":""},children:[Object(m.jsx)("td",{children:t.name}),Object(m.jsx)("td",{children:t.description}),Object(m.jsxs)("td",{children:["$",parseInt(t.price).toLocaleString()]}),Object(m.jsx)("td",{children:t.quantity}),Object(m.jsxs)("td",{children:["$",parseInt(t.total).toLocaleString()]}),Object(m.jsx)("td",{children:Object(m.jsxs)("div",{id:"wrap",children:[Object(m.jsx)("div",{id:"left",children:Object(m.jsx)(S.a,{variant:"info",className:"center",onClick:function(t){return e.handleEdit(t,a)},children:Object(m.jsx)(le.c,{})})}),Object(m.jsx)("div",{id:"left",children:Object(m.jsx)(S.a,{variant:"secondary",className:"center",onClick:function(t){return e.handleIgnore(t,a)},children:t.ignore?Object(m.jsx)(le.g,{}):Object(m.jsx)(le.h,{})})}),Object(m.jsx)("div",{id:"right",children:Object(m.jsx)(S.a,{variant:"danger",className:"center",onClick:function(t){return e.handleDelete(t,a)},children:Object(m.jsx)(le.j,{})})})]})})]},t.name)}))})]})]})]})}}]),a}(n.a.Component),ze=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(x.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).state={restaurantes:[]},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(m.jsxs)("div",{className:"container-fluid",children:[Object(m.jsx)("div",{className:"row",id:"banner",children:Object(m.jsx)("div",{className:"col-2 col-offset-0",children:Object(m.jsx)(M,{showLinks:!0,history:this.props.history})})}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("div",{className:"color",children:Object(m.jsxs)("ol",{className:"breadcrumb",children:[Object(m.jsx)("li",{className:"breadcrumb-item",children:Object(m.jsx)("a",{href:"/",children:"Inicio"})}),Object(m.jsx)("li",{className:"breadcrumb-item",children:"Informaci\xf3n \xfatil"}),Object(m.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:"Documentos"})]})})]})}}]),a}(n.a.Component),Ae=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).handleSave=function(){var e=s.name.value,t=s.price.value,a=s.link.value;if(s.handleValidation()){s.handleClose();var n={};void 0!==s.props.toEdit?(n={id:s.props.toEdit.id,name:e,price:t,link:a,buyed:s.props.toEdit.buyed,ignore:s.props.toEdit.ignore},s.props.handleUpdate(n)):(n={name:e,price:t,link:a,buyed:!1,ignore:!1},s.props.handleSave(n))}},s.handleShow=function(){s.props.handleShow(!0)},s.handleClose=function(){s.props.handleShow(!1)},s.state={errors:{}},s}return Object(v.a)(a,[{key:"handleValidation",value:function(){var e={},t=!0;return""===this.name.value&&(t=!1,e.name="Ingrese el nombre del objeto"),""===this.price.value&&(t=!1,e.price="Ingrese el precio del objeto"),this.setState({errors:e}),t}},{key:"render",value:function(){var e=this;return Object(m.jsxs)(w.a,{show:this.props.show,onHide:this.handleClose,backdrop:"static",keyboard:!1,children:[Object(m.jsx)(w.a.Header,{closeButton:!0,children:Object(m.jsx)(w.a.Title,{children:"Agregar objeto"})}),Object(m.jsx)(w.a.Body,{children:Object(m.jsxs)(Se.a,{children:[Object(m.jsxs)(Se.a.Group,{className:"mb-3",children:[Object(m.jsx)(Se.a.Label,{children:"Nombre"}),Object(m.jsx)(Se.a.Control,{type:"text",placeholder:"Nombre del objeto",ref:function(t){return e.name=t},defaultValue:void 0!==this.props.toEdit?this.props.toEdit.name:"",maxLength:"30"}),Object(m.jsx)("span",{className:"error",style:{color:"red"},children:this.state.errors.name})]}),Object(m.jsxs)(Se.a.Group,{className:"mb-3",children:[Object(m.jsx)(Se.a.Label,{children:"Precio"}),Object(m.jsx)(Se.a.Control,{type:"number",placeholder:"Precio del objeto",ref:function(t){return e.price=t},defaultValue:void 0!==this.props.toEdit?this.props.toEdit.price:"",min:"1",step:"any"}),Object(m.jsx)("span",{className:"error",style:{color:"red"},children:this.state.errors.price})]}),Object(m.jsxs)(Se.a.Group,{className:"mb-3",children:[Object(m.jsx)(Se.a.Label,{children:"Link (si aplica)"}),Object(m.jsx)(Se.a.Control,{type:"text",placeholder:"Link",ref:function(t){return e.link=t},defaultValue:void 0!==this.props.toEdit?this.props.toEdit.link:""})]})]})}),Object(m.jsxs)(w.a.Footer,{children:[Object(m.jsx)(S.a,{variant:"secondary",onClick:this.handleClose,children:"Close"}),Object(m.jsx)(S.a,{variant:"primary",onClick:this.handleSave,children:void 0!==this.props.toEdit?"Editar":"Agregar"})]})]})}}]),a}(n.a.Component),Ve=function(e){return Object(m.jsx)(ie.a,{placement:"bottom",delay:{show:250,hide:200},overlay:Object(m.jsx)(ke.a,{children:e}),children:Object(m.jsx)("button",{type:"button",style:{backgroundColor:"white",borderStyle:"none"},children:Object(m.jsx)(le.e,{color:"grey",size:"1.3em"})})})},Ye=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).componentDidUpdate=function(){s.state.shouldBlockNavigation?window.onbeforeunload=function(){return!0}:window.onbeforeunload=void 0},s.handleEdit=function(e,t){var a=Object(te.a)(s.state.objectsList),n=a.findIndex((function(e){return e.id===t}));s.setState({toEdit:a[n],show:!0})},s.handleUpdate=function(e){var t=Object(te.a)(s.state.objectsList),a=t.findIndex((function(t){return t.id===e.id}));t[a]=e,s.setState({objectsList:t,toEdit:void 0}),s.setState({shouldBlockNavigation:!0})},s.handleIgnore=function(e,t){var a=Object(te.a)(s.state.objectsList),n=a.findIndex((function(e){return e.id===t}));a[n].ignore=!a[n].ignore,s.setState({objectsList:a}),s.setState({shouldBlockNavigation:!0})},s.handleDelete=function(e,t){var a=Object(te.a)(s.state.objectsList),n=a.findIndex((function(e){return e.id===t}));a.splice(n,1),a.forEach((function(e,t){e.id=t})),s.setState({objectsList:a}),s.setState({shouldBlockNavigation:!0})},s.handlePayed=function(e,t){var a=Object(te.a)(s.state.objectsList),n=a.findIndex((function(e){return e.id===t})),r=e.target,i="checkbox"===r.type?r.checked:r.value;a[n].buyed=i,s.setState({objectsList:a}),s.setState({shouldBlockNavigation:!0})},s.handleSave=function(e){var t=s.state.objectsList;e.id=t.length,t.push(e),s.setState({objectsList:t}),s.setState({shouldBlockNavigation:!0})},s.handleShow=function(e){s.setState({show:e,toEdit:void 0})},s.handleClose=function(){s.setState({showSaved:!1})},s.handleSaveChanges=function(){s.props.saveList(s.state.objectsList,s.props.tableNumber),s.setState({showSaved:!0}),s.setState({shouldBlockNavigation:!1})},s.state={objectsList:[],show:!1,toEdit:void 0,showSaved:!1,shouldBlockNavigation:!1},s}return Object(v.a)(a,[{key:"componentDidMount",value:function(){this.setState({objectsList:this.props.objList})}},{key:"render",value:function(){var e=this;return Object(m.jsxs)("div",{children:[Object(m.jsx)(d.a,{when:this.state.shouldBlockNavigation,message:"Hay cambios sin guardar. \xbfDesea salir sin guardarlos?"}),Object(m.jsx)(Ae,{show:this.state.show,handleSave:this.handleSave,handleShow:this.handleShow,toEdit:this.state.toEdit,handleUpdate:this.handleUpdate}),Object(m.jsx)(Be,{title:"Lista de compras",showSaved:this.state.showSaved,handleShow:this.handleClose}),Object(m.jsxs)(Y.a,{children:[Object(m.jsxs)(U.a,{xs:6,lg:4,children:["  ",Object(m.jsxs)("h3",{children:[Ve(this.props.titleTooltip),this.props.title]})]}),Object(m.jsx)(U.a,{xs:6,lg:8,children:Object(m.jsxs)("div",{className:"float-right",children:[Object(m.jsx)(ie.a,{placement:"bottom",delay:{show:250,hide:200},overlay:Object(m.jsx)(ke.a,{children:"Guardar la tabla. Si no se guarda, se descartar\xe1n los cambios al salir de la pesta\xf1a."}),children:Object(m.jsxs)(S.a,{variant:"success",className:"inline",onClick:this.handleSaveChanges,disabled:!this.state.shouldBlockNavigation,children:[Object(m.jsx)(le.i,{style:{marginRight:"10px"}}),"Guardar cambios"]})}),Object(m.jsx)(ie.a,{placement:"bottom",delay:{show:250,hide:200},overlay:Object(m.jsx)(ke.a,{children:"Agregar un elemento a la tabla."}),children:Object(m.jsxs)(S.a,{variant:"primary",className:"inline",onClick:this.handleShow,children:[Object(m.jsx)(le.d,{style:{marginRight:"10px"}}),"Agregar objeto"]})})]})})]}),Object(m.jsxs)(Pe.a,{striped:!0,bordered:!0,hover:!0,children:[Object(m.jsx)("thead",{children:Object(m.jsxs)("tr",{children:[Object(m.jsx)("th",{style:{width:"10%"},children:"#"}),Object(m.jsx)("th",{children:"Nombre"}),Object(m.jsx)("th",{children:"Precio"}),Object(m.jsx)("th",{children:"Comprado"}),Object(m.jsxs)("th",{children:[Ve("Puede editar el elemento, ignorar el elemento (para no tenerlo en cuenta en el total) o eliminarlo de la tabla."),"Acciones"]})]})}),Object(m.jsx)("tbody",{children:this.state.objectsList.map((function(t){return Object(m.jsxs)("tr",{style:{backgroundColor:t.ignore?"grey":""},children:[Object(m.jsx)("td",{children:t.id}),Object(m.jsx)("td",{children:""!==t.link?Object(m.jsx)("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",children:t.name}):t.name}),Object(m.jsxs)("td",{children:["$",parseInt(t.price).toLocaleString()]}),Object(m.jsx)("td",{children:Object(m.jsx)("div",{className:"form-check",children:Object(m.jsx)("input",{className:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault",checked:t.buyed,onChange:function(a){return e.handlePayed(a,t.id)}})})}),Object(m.jsx)("td",{children:Object(m.jsxs)("div",{id:"wrap",children:[Object(m.jsx)("div",{id:"left",children:Object(m.jsx)(S.a,{variant:"info",className:"center",onClick:function(a){return e.handleEdit(a,t.id)},children:Object(m.jsx)(le.c,{})})}),Object(m.jsx)("div",{id:"left",children:Object(m.jsx)(S.a,{variant:"secondary",className:"center",onClick:function(a){return e.handleIgnore(a,t.id)},children:t.ignore?Object(m.jsx)(le.g,{}):Object(m.jsx)(le.h,{})})}),Object(m.jsx)("div",{id:"right",children:Object(m.jsx)(S.a,{variant:"danger",className:"center",onClick:function(a){return e.handleDelete(a,t.id)},children:Object(m.jsx)(le.j,{})})})]})})]},t.id)}))})]}),Object(m.jsxs)("p",{children:["Total compras: $",this.state.objectsList.filter((function(e){return!1===e.ignore})).reduce((function(e,t){return e+parseInt(t.price)}),0).toLocaleString()," "]})]})}}]),a}(n.a.Component),Ue=A().store,_e=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).saveList=function(e,t){var a=s.state.trip.id,n={};"1"===t?n.beforeList=e:n.afterList=e,document.querySelectorAll(".tooltip").forEach((function(e){e.style.display="none"})),G.a.put("http://localhost:5000/shoppingLists/"+a,n).then((function(e){console.log("updated lists")}))},s.state={trip:{},beforeList:[],afterList:[],k1:0,k2:1},s}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=Ue.getState().trip.selectedTrip;void 0!==t?this.setState({trip:t}):this.props.history.push("/plan");var a=t.id;G.a.get("http://localhost:5000/shoppingLists/"+a,{headers:{"Content-Type":"application/json"}}).then((function(t){var s=t.data;if(0===s.length){var n={tripId:a,beforeList:[],afterList:[]};G.a.post("http://localhost:5000/shoppingLists",n).then((function(e){console.log("savedNewList")}))}else e.setState({beforeList:s[0].beforeList,afterList:s[0].afterList,k1:e.state.k1+1,k2:e.state.k2+1})}))}},{key:"render",value:function(){return Object(m.jsxs)("div",{className:"container-fluid",children:[Object(m.jsx)("div",{className:"row",id:"banner",children:Object(m.jsx)("div",{className:"col-2 col-offset-0",children:Object(m.jsx)(M,{showLinks:!0,history:this.props.history})})}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("div",{className:"color",children:Object(m.jsxs)("ol",{className:"breadcrumb",children:[Object(m.jsx)("li",{className:"breadcrumb-item",children:Object(m.jsx)("a",{href:"/",children:"Inicio"})}),Object(m.jsx)("li",{className:"breadcrumb-item",children:"Informaci\xf3n \xfatil"}),Object(m.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:"Lista de compras"})]})}),Object(m.jsx)(D.a,{fluid:!0,children:Object(m.jsxs)(Y.a,{children:[Object(m.jsx)(U.a,{xs:12,xl:6,children:Object(m.jsx)(Ye,{title:"Compras antes del viaje",tableNumber:"1",saveList:this.saveList,objList:this.state.beforeList,titleTooltip:"Objetos que desea comprar antes del viaje. Puede guardarlos en la tabla con su respectivo link de compra (si aplica) para recordar comprarlos."},this.state.k1)}),Object(m.jsx)(U.a,{xs:12,xl:6,children:Object(m.jsx)(Ye,{title:"Compras durante el viaje",tableNumber:"2",saveList:this.saveList,objList:this.state.afterList,titleTooltip:"Objetos que desea comprar durante el viaje. Puede guardarlos en la tabla con su respectivo link de compra (si aplica) para recordar comprarlos."},this.state.k2)})]})})]})}}]),a}(n.a.Component),Ge=a(199),We=a.n(Ge),Ke=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).handleNoteEdit=function(e){s.setState({title:e}),s.props.handleChange(s.state.id,e,s.state.text)},s.handleNoteEditText=function(e){s.setState({text:e}),s.props.handleChange(s.state.id,s.state.title,e)},s.handleDelete=function(){s.props.deleteNote(s.state.id)},s.state={id:s.props.noteId,title:s.props.title,text:s.props.text},s.contentEditable=n.a.createRef(),s}return Object(v.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(m.jsxs)("a",{children:[Object(m.jsx)("span",{id:"close",onClick:this.handleDelete,children:"x"}),Object(m.jsx)(We.a,{tag:"h2",type:"text",maxLength:"20",onChange:this.handleNoteEdit,value:this.state.title}),Object(m.jsx)(We.a,{tag:"p",type:"text",maxLength:"60",onChange:this.handleNoteEditText,value:this.state.text})]})}}]),a}(n.a.Component),$e=A().store,Qe=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).handleAdd=function(){var e=Object(te.a)(s.state.stickyNotes);e.push({id:e.length,title:"T\xedtulo nota",text:"Modifica este texto!"}),s.setState({stickyNotes:e,shouldBlockNavigation:!0})},s.handleDeleteNote=function(e){var t=Object(te.a)(s.state.stickyNotes);t.splice(e,1),t.forEach((function(e,t){e.id=t})),s.setState({stickyNotes:t,shouldBlockNavigation:!0})},s.handleNoteChange=function(e,t,a){var n=Object(te.a)(s.state.stickyNotes);n[e].title=t,n[e].text=a,s.setState({stickyNotes:n,shouldBlockNavigation:!0})},s.handleSaveChanges=function(){document.querySelectorAll(".tooltip").forEach((function(e){e.style.display="none"}));var e=s.state.trip.id;G.a.put("http://localhost:5000/notes/"+e,{stickyNotes:s.state.stickyNotes}).then((function(e){console.log("updated notes"),s.setState({showSaved:!0,shouldBlockNavigation:!1})}))},s.handleClose=function(){s.setState({showSaved:!1})},s.state={stickyNotes:[{id:0,title:"T\xedtulo nota",text:"Modifica este texto!"}],showSaved:!1,shouldBlockNavigation:!1},s.contentEditable=n.a.createRef(),s}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=$e.getState().trip.selectedTrip;void 0!==t?this.setState({trip:t}):this.props.history.push("/plan");var a=t.id;G.a.get("http://localhost:5000/notes/"+a,{headers:{"Content-Type":"application/json"}}).then((function(t){var s=t.data;if(console.log(s),0===s.length){var n={tripId:a,stickyNotes:e.state.stickyNotes};G.a.post("http://localhost:5000/notes",n).then((function(e){console.log("savedNewNote")}))}else e.setState({stickyNotes:s[0].stickyNotes})}))}},{key:"render",value:function(){var e=this;return Object(m.jsxs)("div",{className:"container-fluid",style:{paddingLeft:"0px",paddingRight:"0px"},children:[Object(m.jsx)("div",{className:"row",id:"banner",children:Object(m.jsx)("div",{className:"col-2 col-offset-0",children:Object(m.jsx)(M,{showLinks:!0,history:this.props.history})})}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("div",{className:"color",children:Object(m.jsxs)("ol",{className:"breadcrumb",style:{marginBottom:"0px",marginLeft:"0px"},children:[Object(m.jsx)("li",{className:"breadcrumb-item",children:Object(m.jsx)("a",{href:"/",children:"Inicio"})}),Object(m.jsx)("li",{className:"breadcrumb-item",children:"Informaci\xf3n \xfatil"}),Object(m.jsx)("li",{className:"breadcrumb-item active","aria-current":"page",children:"Notas"})]})}),Object(m.jsx)(d.a,{when:this.state.shouldBlockNavigation,message:"Hay cambios sin guardar. \xbfDesea salir sin guardarlos?"}),Object(m.jsx)(Be,{title:"Notas",showSaved:this.state.showSaved,handleShow:this.handleClose}),Object(m.jsx)("div",{style:{backgroundColor:"#666",height:"70px"},children:Object(m.jsxs)("div",{className:"inline float-right",style:{paddingTop:"10px",paddingBottom:"20px"},children:[Object(m.jsx)(ie.a,{placement:"bottom",delay:{show:250,hide:200},overlay:Object(m.jsx)(ke.a,{children:"Guardar las notas. Si no se guardan, se descartar\xe1n los cambios al salir de la pesta\xf1a."}),children:Object(m.jsxs)(S.a,{variant:"success",className:"inline",onClick:this.handleSaveChanges,disabled:!this.state.shouldBlockNavigation,children:[Object(m.jsx)(le.i,{style:{marginRight:"10px"}}),"Guardar cambios"]})}),Object(m.jsx)(ie.a,{placement:"bottom",delay:{show:250,hide:200},overlay:Object(m.jsx)(ke.a,{children:"Agregar una nota."}),children:Object(m.jsxs)(S.a,{variant:"primary",className:"inline float-right",onClick:this.handleAdd,children:[Object(m.jsx)(le.d,{style:{marginRight:"10px"}}),"Agregar nota"]})})]})}),Object(m.jsx)("div",{className:"container-fluid notes-container",style:{paddingLeft:"0px",paddingRight:"0px"},children:Object(m.jsx)("ul",{style:{paddingTop:"30px"},children:this.state.stickyNotes.map((function(t,a){return Object(m.jsx)("li",{children:Object(m.jsx)(Ke,{noteId:a,deleteNote:e.handleDeleteNote,handleChange:e.handleNoteChange,title:t.title,text:t.text})},a)}))})})]})}}]),a}(n.a.Component),Ze=a(265),Je=(a(445),a(446),a(267)),Xe=a(266),et=A().store,tt=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var s;return Object(x.a)(this,a),(s=t.call(this,e)).selectTrip=function(e,t){s.props.changeTrip(t),s.props.history.push("/mytrip")},s.deleteTrip=function(e,t){if(window.confirm("\xbfEst\xe1 seguro de que desea eliminar el viaje a "+t.selectedCity.split(",")[0]+"?")){var a=Object(te.a)(s.state.trips),n=a.findIndex((function(e){return e.id===t.id}));a.splice(n,1),G.a.delete("http://localhost:5000/trips/"+t.id).then((function(e){var t={trips:a.map((function(e){return e.id}))};G.a.put("http://localhost:5000/userTrips/"+s.state.userId,t).then((function(e){console.log("updated trips"),s.setState({trips:a})}))}))}},s.promiseOptions=function(e,t){if(!e)return t([]);e.length>=3&&G.a.get("http://localhost:5000/countries/"+s.state.selectedCountry+"/"+e,{headers:{"Content-Type":"application/json"}}).then((function(e){t(s.mapOptionsToValues(e.data))}))},s.mapOptionsToValues=function(e){return e.map((function(e){return{value:e.city+","+e.latitude+","+e.longitude,label:e.city+" - "+e.region}}))},s.state={calendar:{startDate:new Date,endDate:new Date,key:"selection"},countries:[],isClearable:!0,cities:[],isDisabled:!0,selectedCountry:"",selectedCity:"",invalidData:!0,numOfTrips:"",trips:[],userId:""},s.handleSelect=s.handleSelect.bind(Object(ee.a)(s)),s.handleCountrySelect=s.handleCountrySelect.bind(Object(ee.a)(s)),s.handleSubmit=s.handleSubmit.bind(Object(ee.a)(s)),s.promiseOptions=s.promiseOptions.bind(Object(ee.a)(s)),s.mapOptionsToValues=s.mapOptionsToValues.bind(Object(ee.a)(s)),s.handleCitySelect=s.handleCitySelect.bind(Object(ee.a)(s)),s}return Object(v.a)(a,[{key:"componentWillUpdate",value:function(e,t){t.invalidData=!(t.selectedCity&&t.selectedCountry)}},{key:"componentDidMount",value:function(){var e=this,t=et.getState().user.user;void 0===t&&this.props.history.push("/");var a=t.sub;this.setState({userId:t.sub}),G.a.get("http://localhost:5000/countries",{headers:{"Content-Type":"application/json"}}).then((function(t){var a=t.data.map((function(e){return{value:e.code,label:e.name}}));e.setState({countries:a})})),G.a.get("http://localhost:5000/userTrips/"+a,{headers:{"Content-Type":"application/json"}}).then((function(t){if(0===t.data.length){var s={userId:a,trips:[]};G.a.post("http://localhost:5000/userTrips",s).then((function(e){console.log("savedNewUserTrips")}))}else{var n=t.data[0].trips;e.setState({numOfTrips:n.length,trips:n})}}))}},{key:"handleCountrySelect",value:function(e){e?(this.setState({isDisabled:!1}),this.setState({selectedCountry:e.value})):(this.setState({isDisabled:!0}),this.setState({selectedCountry:""}))}},{key:"handleCitySelect",value:function(e){e?this.setState({selectedCity:e.value}):this.setState({selectedCity:""})}},{key:"handleSelect",value:function(e){this.setState({calendar:e})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a={id:this.state.userId+(this.state.numOfTrips+1).toString(),calendar:this.state.calendar,selectedCountry:this.state.selectedCountry,selectedCity:this.state.selectedCity};G.a.post("http://localhost:5000/trips",a).then((function(e){var s=t.state.trips;s.push(a);var n={trips:s.map((function(e){return e.id}))};G.a.put("http://localhost:5000/userTrips/"+t.state.userId,n).then((function(e){console.log("updated trips"),t.setState({trips:s}),t.props.changeTrip(a),t.props.history.push("/mytrip")}))}))}},{key:"render",value:function(){var e=this;return Object(m.jsxs)("div",{children:[Object(m.jsx)(M,{isLoggedIn:!0,showLinks:!1,history:this.props.history}),Object(m.jsx)("div",{className:"hero-container",children:Object(m.jsx)("div",{className:"hero-image",children:Object(m.jsxs)(D.a,{fluid:!0,className:"hero-text roboto",children:[Object(m.jsx)(Y.a,{children:Object(m.jsx)("div",{id:"section1",children:Object(m.jsx)("div",{children:Object(m.jsx)("h1",{className:"title",children:" La nueva manera de planear tu viaje "})})})}),Object(m.jsxs)(Y.a,{children:[Object(m.jsxs)("div",{className:"placeform",children:[Object(m.jsx)("form",{className:"placeformform roboto",onSubmit:this.handleSubmit,children:Object(m.jsxs)(Y.a,{children:[Object(m.jsxs)(U.a,{xs:12,md:12,lg:5,children:[" ",Object(m.jsxs)(Y.a,{children:[" ",Object(m.jsx)("label",{className:"labelmargin",children:" Fechas "})]}),Object(m.jsx)(Y.a,{children:Object(m.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(m.jsx)(Ze.DateRange,{editableDateInputs:!0,moveRangeOnFirstSelection:!1,ranges:[this.state.calendar],onChange:function(t){return e.handleSelect(t.selection)},minDate:new Date})})})]})," ",Object(m.jsx)(U.a,{xs:0,md:0,lg:1}),Object(m.jsxs)(U.a,{xs:12,md:12,lg:6,children:[Object(m.jsx)(Y.a,{children:Object(m.jsx)("label",{className:"labelmargin",children:" Pa\xeds "})}),Object(m.jsx)(Y.a,{className:"geoInput",children:Object(m.jsxs)("div",{className:"vertical",children:[Object(m.jsx)(Je.a,{options:this.state.countries,isClearable:this.state.isClearable,placeholder:"Ingresa el pa\xeds destino",onChange:this.handleCountrySelect})," "]})}),Object(m.jsx)(Y.a,{children:Object(m.jsx)("label",{className:"labelmargin",children:" Ciudad "})}),Object(m.jsx)(Y.a,{className:"geoInput",children:Object(m.jsxs)("div",{className:"vertical",children:[Object(m.jsx)(Xe.a,{cacheOptions:!0,loadOptions:this.promiseOptions,placeholder:"Ingresa la ciudad destino",isDisabled:this.state.isDisabled,onChange:this.handleCitySelect,theme:function(e){return Object(u.a)(Object(u.a)({},e),{},{borderRadius:0,colors:Object(u.a)(Object(u.a)({},e.colors),{},{neutral5:"silver",neutral10:"silver",primary:"black"})})}})," "]})}),Object(m.jsx)(Y.a,{children:Object(m.jsx)("button",{type:"submit",className:"btn btn-primary submitbtn",disabled:this.state.invalidData,children:" Aceptar "})})]})]})})," "]})," "]})]})})}),Object(m.jsx)("div",{style:{backgroundColor:"black"},children:Object(m.jsxs)("div",{className:"trips-container",children:[Object(m.jsx)("h2",{className:"left-pad",children:"Mis viajes"}),Object(m.jsx)("div",{className:"left-pad",children:Object(m.jsx)(Y.a,{children:this.state.trips.map((function(t){return Object(m.jsx)(U.a,{lg:4,children:Object(m.jsxs)(V.a,{style:{marginBottom:"15px"},children:[Object(m.jsx)(V.a.Header,{as:"h5",children:t.selectedCity.split(",")[0]}),Object(m.jsxs)(V.a.Body,{children:[Object(m.jsxs)(V.a.Text,{children:[me()(t.calendar.startDate).format("DD/MMM/YYYY")," - ",me()(t.calendar.endDate).format("DD/MMM/YYYY")]}),Object(m.jsxs)("form",{className:"my-2 my-lg-0 center",children:[Object(m.jsx)(S.a,{variant:"primary",onClick:function(a){return e.selectTrip(a,t)},className:"inline center",children:"Seleccionar"}),Object(m.jsx)(S.a,{variant:"danger",className:"inline center",onClick:function(a){return e.deleteTrip(a,t)},children:"Eliminar viaje"})]})]})]})},t.id)}))})})]})})]})}}]),a}(n.a.Component),at=Object(j.b)(null,(function(e){return{changeTrip:function(t){return e({type:"trip/selectedChanged",payload:t})}}}))(tt),st=a(5),nt=["component"],rt=Object(m.jsx)("div",{className:"loading",children:Object(m.jsx)("div",{className:"loader"})}),it=function(e){var t=e.component,a=Object(st.a)(e,nt);return Object(m.jsx)(d.c,Object(u.a)({component:Object(h.c)(t,{onRedirecting:function(){return rt}})},a))};function ct(e){var t=Object(h.b)().loginWithRedirect;return Object(m.jsxs)("div",{className:"container-fluid",style:{paddingLeft:"0px",paddingRight:"0px"},children:[Object(m.jsx)("div",{className:"row",id:"banner",children:Object(m.jsx)("div",{className:"col-2 col-offset-0",children:Object(m.jsx)(M,{showLinks:!1,history:e.history})})}),Object(m.jsx)("div",{className:"init-hero-image",children:Object(m.jsxs)("div",{className:"init-hero-text",style:{fontFamily:"roboto"},children:[Object(m.jsx)("img",{src:"logotrip.png",alt:"tripplanner icon",className:"init-icon"}),Object(m.jsx)("h1",{children:"Bienvenido a TriPlanner"}),Object(m.jsx)("p",{children:"Aqu\xed puedes planear tu viaje de manera f\xe1cil y divertida"}),Object(m.jsx)("div",{class:"container",children:Object(m.jsxs)(Y.a,{children:[Object(m.jsx)(U.a,{className:"page-hero d-flex align-items-center justify-content-center",children:Object(m.jsxs)(V.a,{style:{width:"18rem",height:"26rem"},children:[Object(m.jsx)(V.a.Img,{variant:"top",src:"route_google_map.png",style:{height:"16rem"}}),Object(m.jsxs)(V.a.Body,{children:[Object(m.jsx)(V.a.Title,{children:"Selecciona lugares"}),Object(m.jsx)(V.a.Text,{children:"Busca los lugares que quieres visitar en el mapa, gu\xe1rdalos y organ\xedzalos por colores."})]})]})}),Object(m.jsx)(U.a,{className:"page-hero d-flex align-items-center justify-content-center",children:Object(m.jsxs)(V.a,{style:{width:"18rem",height:"26rem"},children:[Object(m.jsx)(V.a.Img,{variant:"top",src:"schedule.png",style:{height:"16rem"}}),Object(m.jsxs)(V.a.Body,{children:[Object(m.jsx)(V.a.Title,{children:"Planea tus visitas"}),Object(m.jsx)(V.a.Text,{children:"Planea cuando quieres visitar cada lugar seleccionado, teniendo en cuenta el tiempo de transporte entre lugares."})]})]})}),Object(m.jsx)(U.a,{className:"page-hero d-flex align-items-center justify-content-center",children:Object(m.jsxs)(V.a,{style:{width:"18rem",height:"26rem"},className:"budget-card",children:[Object(m.jsx)(V.a.Img,{variant:"top",src:"budget.png",style:{height:"16rem"}}),Object(m.jsxs)(V.a.Body,{children:[Object(m.jsx)(V.a.Title,{children:"Planea tus gastos"}),Object(m.jsx)(V.a.Text,{children:"Crea listas de compras y crea un presupuesto para tu viaje."})]})]})})]})}),Object(m.jsx)("br",{}),Object(m.jsx)("p",{children:"Inicia sesi\xf3n para planear tu viaje"}),Object(m.jsx)(S.a,{variant:"success",className:"center",onClick:function(){return t()},children:"Iniciar sesi\xf3n"})]})})]})}var lt=Object(d.h)((function(e){return Object(m.jsxs)("div",{children:[Object(m.jsx)(d.c,{exact:!0,path:"/callback",render:function(){return Object(m.jsx)(O,{auth:e.auth})}}),Object(m.jsx)(d.c,{exact:!0,path:"/",render:function(){return Object(m.jsx)(ct,{authenticated:!1,history:e.history})}}),Object(m.jsx)(it,{path:"/plan",component:at,exact:!0}),Object(m.jsx)(it,{path:"/mytrip",component:X,exact:!0}),Object(m.jsx)(it,{path:"/map/",component:xe,exact:!0}),Object(m.jsx)(it,{path:"/schedule",component:Le,exact:!0}),Object(m.jsx)(it,{path:"/budget",component:Re,exact:!0}),Object(m.jsx)(it,{path:"/documents",component:ze,exact:!0}),Object(m.jsx)(it,{path:"/list",component:_e,exact:!0}),Object(m.jsx)(it,{path:"/notes",component:Qe,exact:!0})]})})),ot=function(e){var t=e.children,a=Object(d.g)();return Object(m.jsx)(h.a,{domain:"dev-pxvk0q3d.us.auth0.com",clientId:"F7YgSVBKnopGhKfsYchWk1tSx0gBlpZM",redirectUri:"http://localhost:3000/callback",onRedirectCallback:function(e){a.push((null===e||void 0===e?void 0:e.returnTo)||window.location.pathname)},children:t})},dt=a(268),ht=A(),jt=ht.store,ut=ht.persistor;i.a.render(Object(m.jsx)(j.a,{store:jt,children:Object(m.jsx)(dt.a,{loading:null,persistor:ut,children:Object(m.jsx)(l.a,{history:o.a,children:Object(m.jsx)(ot,{children:Object(m.jsx)(lt,{})})})})}),document.getElementById("root")),c()}},[[454,1,2]]]);
//# sourceMappingURL=main.92af2c84.chunk.js.map